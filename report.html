<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /><title>Cosmic Ray Report</title></head><body><div class="container"><h1><p class="text-dark">Cosmic Ray Report</p></h1></div><div class="container"><div class="mb-1" id="summary_info___accordion"><div class="card"><a data-toggle="collapse" data-target="#summary_info___collapse_1" aria-expanded="true" aria-controls="summary_info___collapse_1" href="#"><div class="card-header" id="summary_info___heading_1"><button class="btn btn-outline-dark"><h4 class="m-0">Summary info</h4></button></div></a><div aria-labelledby="summary_info___heading_1" data-parent="#summary_info___accordion" class="collapse show" id="summary_info___collapse_1"><div class="card-body"><p>Date time: 16/11/2023 08:39:55</p><p>Total jobs: 127</p><p>Complete: 127 (100.00%)</p><p>Surviving mutants: 26 (20.47%)</p></div></div></div></div><div class="mb-1" id="job_list___accordion"><div class="card"><a data-toggle="collapse" data-target="#job_list___collapse_1" aria-expanded="false" aria-controls="job_list___collapse_1" href="#"><div class="card-header" id="job_list___heading_1"><button class="btn btn-outline-dark"><h4 class="m-0">Job list</h4></button></div></a><div aria-labelledby="job_list___heading_1" data-parent="#job_list___accordion" class="collapse" id="job_list___collapse_1"><div class="card-body"><div class="text-right mb-1"><div class="mx-1" id="job_item_expand_all"><a href="#" onclick="$('div.job_list___sub_multi_collapse').collapse('show');"><button class="btn btn-outline-dark"><span>Expand All</span></button></a></div><div class="mx-1" id="job_item_collapse_all"><a href="#" onclick="$('div.job_list___sub_multi_collapse').collapse('hide');"><button class="btn btn-outline-dark"><span>Collapse All</span></button></a></div></div><div class="mb-1" id="job_list___sub_accordion_1"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_1_1" aria-expanded="false" aria-controls="job_list___sub_collapse_1_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_1_1"><button class="btn btn-outline-success"><span class="job_id">1 : Job ID cd4f0e838b824724b8a89798cf8400d6</span></button></div></a><div aria-labelledby="job_list___sub_heading_1_1" data-parent="#job_list___sub_accordion_1" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_1_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user_id_generator.py&amp;line=15" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user_id_generator.py, start pos: (15, 24), end pos: (15, 26)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Is_IsNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user_id_generator.py
+++ bapp/authentication/user_id_generator.py
@@ -12,7 +12,7 @@
 
 class UserIDGenerator:
     def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
-        if user_id_salt is None:
+        if user_id_salt is not None:
             raise ValueError("user_id_salt is required")
         if user_ik_salt is None:
             raise ValueError("user_ik_salt is required")</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................FFFFEEE.EEFEE.EE                                   [100%]
==================================== ERRORS ====================================
___________ ERROR at setup of test_no_user_when_session_has_expired ____________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_no_user_when_session_has_expired&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x108116390&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1080fa350&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

_________ ERROR at setup of test_check_session_with_user_id_in_session _________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1098acb90&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1098978d0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x112c426d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x112c27910&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_should_raise_jti_token_used_when_token_already_exists _
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_raise_jti_token_used_when_token_already_exists&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x110646c90&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x110615090&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

_______________________ ERROR at setup of test_load_user _______________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x113e2fe50&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x113ceabd0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1080c1290&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x108125750&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_should_use_token ____________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_use_token&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x108903c10&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x108923810&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

_______ ERROR at setup of test_check_session_with_no_user_id_in_session ________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_no_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10985c310&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2023-11-16 08:13:01 [debug    ] reading from file              filename=.application-version
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:01 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1098c1350&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_request_load_user ___________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_request_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x113e4f7d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x113f33110&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:04 [info     ] starting eq survey runner      version=local

=================================== FAILURES ===================================
_______________________________ test_generate_id _______________________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_id():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:9: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x107e4ee90&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
_______________________________ test_generate_ik _______________________________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_ik():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:29: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10c7bc590&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
______________ test_create_generator_no_user_id_salt_raises_error ______________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_create_generator_no_user_id_salt_raises_error():
&gt;       with pytest.raises(ValueError):
E       Failed: DID NOT RAISE &lt;class 'ValueError'&gt;

tests/app/authentication/test_user_id_generator.py:49: Failed
________________ test_different_salt_creates_different_user_id _________________
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_id():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:19: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x110a20210&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
________________ test_different_salt_creates_different_user_ik _________________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_ik():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:39: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x110621110&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is not None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_id
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_ik
FAILED tests/app/authentication/test_user_id_generator.py::test_create_generator_no_user_id_salt_raises_error
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_id
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_ik
ERROR tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
ERROR tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
ERROR tests/app/authentication/test_authenticator.py::test_load_user - ValueE...
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
ERROR tests/app/authentication/test_use_token.py::test_should_use_token - Val...
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_request_load_user
============= 5 failed, 24 passed, 325 warnings, 9 errors in 3.83s =============
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_2"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_2_1" aria-expanded="false" aria-controls="job_list___sub_collapse_2_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_2_1"><button class="btn btn-outline-success"><span class="job_id">2 : Job ID db709699a82a4fb1b34dd3ecacc12084</span></button></div></a><div aria-labelledby="job_list___sub_heading_2_1" data-parent="#job_list___sub_accordion_2" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_2_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user_id_generator.py&amp;line=17" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user_id_generator.py, start pos: (17, 24), end pos: (17, 26)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Is_IsNot, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user_id_generator.py
+++ bapp/authentication/user_id_generator.py
@@ -14,7 +14,7 @@
     def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
         if user_id_salt is None:
             raise ValueError("user_id_salt is required")
-        if user_ik_salt is None:
+        if user_ik_salt is not None:
             raise ValueError("user_ik_salt is required")
 
         self._iterations = iterations</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................FEFEEEF.FFEEE.EE                                   [100%]
==================================== ERRORS ====================================
_______________________ ERROR at setup of test_load_user _______________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x113db2d90&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x111e04f50&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:09 [info     ] starting eq survey runner      version=local

_________ ERROR at setup of test_check_session_with_user_id_in_session _________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x109efa410&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x109f34f90&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:09 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_should_raise_jti_token_used_when_token_already_exists _
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_raise_jti_token_used_when_token_already_exists&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10aa78410&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10a08bdd0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:09 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10aa35d10&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10a8b2d50&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:09 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_request_load_user ___________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_request_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x113d59850&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x113dbfad0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:10 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_should_use_token ____________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_use_token&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10826c450&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1081de490&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:09 [info     ] starting eq survey runner      version=local

___________ ERROR at setup of test_no_user_when_session_has_expired ____________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_no_user_when_session_has_expired&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x109c4e790&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x107ca2d50&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:09 [info     ] starting eq survey runner      version=local

_______ ERROR at setup of test_check_session_with_no_user_id_in_session ________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_no_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x109ebe790&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    2023-11-16 08:13:06 [debug    ] reading from file              filename=.application-version
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:06 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x109eef150&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:10 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x109bfc3d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x109c60bd0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:10 [info     ] starting eq survey runner      version=local

=================================== FAILURES ===================================
_______________________________ test_generate_id _______________________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_id():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:9: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10ac719d0&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
________________ test_different_salt_creates_different_user_id _________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_id():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:19: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10ac79f90&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
______________ test_create_generator_no_user_ik_salt_raises_error ______________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_create_generator_no_user_ik_salt_raises_error():
&gt;       with pytest.raises(ValueError):
E       Failed: DID NOT RAISE &lt;class 'ValueError'&gt;

tests/app/authentication/test_user_id_generator.py:54: Failed
_______________________________ test_generate_ik _______________________________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_ik():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:29: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10aaa10d0&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
________________ test_different_salt_creates_different_user_ik _________________
[gw8] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_ik():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:39: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x110bd8f10&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if user_ik_salt is not None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_id
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_id
FAILED tests/app/authentication/test_user_id_generator.py::test_create_generator_no_user_ik_salt_raises_error
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_ik
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_ik
ERROR tests/app/authentication/test_authenticator.py::test_load_user - ValueE...
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
ERROR tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
ERROR tests/app/authentication/test_authenticator.py::test_request_load_user
ERROR tests/app/authentication/test_use_token.py::test_should_use_token - Val...
ERROR tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
============= 5 failed, 24 passed, 325 warnings, 9 errors in 3.81s =============
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_3"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_3_1" aria-expanded="false" aria-controls="job_list___sub_collapse_3_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_3_1"><button class="btn btn-outline-success"><span class="job_id">3 : Job ID 54c02072e39a4a9383d1d2c5af08c64e</span></button></div></a><div aria-labelledby="job_list___sub_heading_3_1" data-parent="#job_list___sub_accordion_3" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_3_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user_id_generator.py&amp;line=15" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user_id_generator.py, start pos: (15, 11), end pos: (15, 31)</button></a></pre><pre>operator: core/AddNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user_id_generator.py
+++ bapp/authentication/user_id_generator.py
@@ -12,7 +12,7 @@
 
 class UserIDGenerator:
     def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
-        if user_id_salt is None:
+        if not user_id_salt is None:
             raise ValueError("user_id_salt is required")
         if user_ik_salt is None:
             raise ValueError("user_ik_salt is required")</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................FFEFFE.F.EEEEEEE                                   [100%]
==================================== ERRORS ====================================
_ ERROR at setup of test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10e703ed0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10e6e3d50&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_should_use_token ____________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_use_token&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1086071d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x108647590&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

___________ ERROR at setup of test_no_user_when_session_has_expired ____________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_no_user_when_session_has_expired&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10ccbaa90&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10ca7dbd0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

_______________________ ERROR at setup of test_load_user _______________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10bab9350&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10b88c090&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_should_raise_jti_token_used_when_token_already_exists _
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_raise_jti_token_used_when_token_already_exists&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1143b4910&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x11424e310&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

_________ ERROR at setup of test_check_session_with_user_id_in_session _________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1130d3050&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1130bb850&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10cc6a610&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10cccad50&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_request_load_user ___________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_request_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10ba81c90&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2023-11-16 08:13:11 [debug    ] reading from file              filename=.application-version
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:12 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10baae310&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

_______ ERROR at setup of test_check_session_with_no_user_id_in_session ________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_no_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x113080e90&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1130e2610&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:15 [info     ] starting eq survey runner      version=local

=================================== FAILURES ===================================
_______________________________ test_generate_id _______________________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_id():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:9: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10518a710&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
_______________________________ test_generate_ik _______________________________
[gw6] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_ik():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:29: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x11315ac10&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
______________ test_create_generator_no_user_id_salt_raises_error ______________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_create_generator_no_user_id_salt_raises_error():
&gt;       with pytest.raises(ValueError):
E       Failed: DID NOT RAISE &lt;class 'ValueError'&gt;

tests/app/authentication/test_user_id_generator.py:49: Failed
________________ test_different_salt_creates_different_user_id _________________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_id():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:19: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x105d7cb50&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
________________ test_different_salt_creates_different_user_ik _________________
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_ik():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:39: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x107948f90&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if not user_id_salt is None:
&gt;           raise ValueError("user_id_salt is required")
E           ValueError: user_id_salt is required

app/authentication/user_id_generator.py:16: ValueError
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_id
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_ik
FAILED tests/app/authentication/test_user_id_generator.py::test_create_generator_no_user_id_salt_raises_error
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_id
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_ik
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
ERROR tests/app/authentication/test_use_token.py::test_should_use_token - Val...
ERROR tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
ERROR tests/app/authentication/test_authenticator.py::test_load_user - ValueE...
ERROR tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
ERROR tests/app/authentication/test_authenticator.py::test_request_load_user
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
============= 5 failed, 24 passed, 325 warnings, 9 errors in 4.09s =============
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_4"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_4_1" aria-expanded="false" aria-controls="job_list___sub_collapse_4_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_4_1"><button class="btn btn-outline-success"><span class="job_id">4 : Job ID bc0dccaf0b024c08881c7ccb86cc549d</span></button></div></a><div aria-labelledby="job_list___sub_heading_4_1" data-parent="#job_list___sub_accordion_4" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_4_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user_id_generator.py&amp;line=17" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user_id_generator.py, start pos: (17, 11), end pos: (17, 31)</button></a></pre><pre>operator: core/AddNot, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user_id_generator.py
+++ bapp/authentication/user_id_generator.py
@@ -14,7 +14,7 @@
     def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
         if user_id_salt is None:
             raise ValueError("user_id_salt is required")
-        if user_ik_salt is None:
+        if not user_ik_salt is None:
             raise ValueError("user_ik_salt is required")
 
         self._iterations = iterations</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................FEEFFFEE.EE.FEEE                                   [100%]
==================================== ERRORS ====================================
_______________________ ERROR at setup of test_load_user _______________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10c17de50&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10c1ba550&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:20 [info     ] starting eq survey runner      version=local

_________ ERROR at setup of test_check_session_with_user_id_in_session _________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1147d5f10&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x114561a50&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:20 [info     ] starting eq survey runner      version=local

___________ ERROR at setup of test_no_user_when_session_has_expired ____________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_no_user_when_session_has_expired&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x114e112d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x114dfe190&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:20 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_should_use_token ____________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_use_token&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x106162550&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x106159e10&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:20 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_should_raise_jti_token_used_when_token_already_exists _
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_raise_jti_token_used_when_token_already_exists&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x114437dd0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x114331290&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:20 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x105f34a90&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x105fae8d0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:20 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_request_load_user ___________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_request_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10c1838d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10c1e7390&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:21 [info     ] starting eq survey runner      version=local

_______ ERROR at setup of test_check_session_with_no_user_id_in_session ________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_no_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x114786810&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
2023-11-16 08:13:17 [debug    ] reading from file              filename=.application-version
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:17 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1147b2b90&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:21 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x114dec090&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:176: in create_app
    application.eq["id_generator"] = UserIDGenerator(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x114eb38d0&gt;
iterations = 10000, user_id_salt = 'this.is.a.dummy.value'
user_ik_salt = 'this.is.a.dummy.value'

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:13:21 [info     ] starting eq survey runner      version=local

=================================== FAILURES ===================================
______________ test_create_generator_no_user_ik_salt_raises_error ______________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_create_generator_no_user_ik_salt_raises_error():
&gt;       with pytest.raises(ValueError):
E       Failed: DID NOT RAISE &lt;class 'ValueError'&gt;

tests/app/authentication/test_user_id_generator.py:54: Failed
_______________________________ test_generate_id _______________________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_id():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:9: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10e3f6d50&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
________________ test_different_salt_creates_different_user_ik _________________
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_ik():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:39: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1054c0750&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
________________ test_different_salt_creates_different_user_id _________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_different_salt_creates_different_user_id():
&gt;       id_generator_1 = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:19: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x10e40a690&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
_______________________________ test_generate_ik _______________________________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_generate_ik():
&gt;       id_generator = UserIDGenerator(ITERATIONS, "", "")

tests/app/authentication/test_user_id_generator.py:29: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user_id_generator.UserIDGenerator object at 0x1144b6610&gt;
iterations = 1000, user_id_salt = '', user_ik_salt = ''

    def __init__(self, iterations: int, user_id_salt: str, user_ik_salt: str) -&gt; None:
        if user_id_salt is None:
            raise ValueError("user_id_salt is required")
        if not user_ik_salt is None:
&gt;           raise ValueError("user_ik_salt is required")
E           ValueError: user_ik_salt is required

app/authentication/user_id_generator.py:18: ValueError
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_user_id_generator.py::test_create_generator_no_user_ik_salt_raises_error
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_id
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_ik
FAILED tests/app/authentication/test_user_id_generator.py::test_different_salt_creates_different_user_id
FAILED tests/app/authentication/test_user_id_generator.py::test_generate_ik
ERROR tests/app/authentication/test_authenticator.py::test_load_user - ValueE...
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
ERROR tests/app/authentication/test_use_token.py::test_should_use_token - Val...
ERROR tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
ERROR tests/app/authentication/test_authenticator.py::test_request_load_user
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
============= 5 failed, 24 passed, 325 warnings, 9 errors in 4.14s =============
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_5"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_5_1" aria-expanded="false" aria-controls="job_list___sub_collapse_5_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_5_1"><button class="btn btn-outline-danger"><span class="job_id">5 : Job ID d6713b43d7b849bbaef395656344abad</span></button></div></a><div aria-labelledby="job_list___sub_heading_5_1" data-parent="#job_list___sub_accordion_5" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_5_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user_id_generator.py&amp;line=37" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user_id_generator.py, start pos: (37, 19), end pos: (37, 21)</button></a></pre><pre>operator: core/NumberReplacer, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user_id_generator.py
+++ bapp/authentication/user_id_generator.py
@@ -34,7 +34,7 @@
     def _generate(self, key_material: str, salt: bytes) -&gt; bytes:
         kdf = PBKDF2HMAC(
             algorithm=hashes.SHA256(),
-            length=32,
+            length= 33,
             salt=salt,
             iterations=self._iterations,
             backend=backend,</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:13:22 [debug    ] reading from file              filename=.application-version
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:23 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 4.03s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_6"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_6_1" aria-expanded="false" aria-controls="job_list___sub_collapse_6_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_6_1"><button class="btn btn-outline-danger"><span class="job_id">6 : Job ID 73e3e764cd5247f8a75a96a89beaece1</span></button></div></a><div aria-labelledby="job_list___sub_heading_6_1" data-parent="#job_list___sub_accordion_6" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_6_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user_id_generator.py&amp;line=37" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user_id_generator.py, start pos: (37, 19), end pos: (37, 21)</button></a></pre><pre>operator: core/NumberReplacer, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user_id_generator.py
+++ bapp/authentication/user_id_generator.py
@@ -34,7 +34,7 @@
     def _generate(self, key_material: str, salt: bytes) -&gt; bytes:
         kdf = PBKDF2HMAC(
             algorithm=hashes.SHA256(),
-            length=32,
+            length= 31,
             salt=salt,
             iterations=self._iterations,
             backend=backend,</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:13:28 [debug    ] reading from file              filename=.application-version
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:13:28 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.65s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_7"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_7_1" aria-expanded="false" aria-controls="job_list___sub_collapse_7_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_7_1"><button class="btn btn-outline-success"><span class="job_id">7 : Job ID 1a8b056445dd475e91002afaf6b94479</span></button></div></a><div aria-labelledby="job_list___sub_heading_7_1" data-parent="#job_list___sub_accordion_7" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_7_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Add, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str + None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str + None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for +: 'type' and 'NoneType'
2023-11-16 08:13:33 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_8"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_8_1" aria-expanded="false" aria-controls="job_list___sub_collapse_8_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_8_1"><button class="btn btn-outline-success"><span class="job_id">8 : Job ID 92400efa85e64a8797ace210aa99cbf6</span></button></div></a><div aria-labelledby="job_list___sub_heading_8_1" data-parent="#job_list___sub_accordion_8" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_8_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Add, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str + None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str + None) -&gt; None:
E   TypeError: unsupported operand type(s) for +: 'type' and 'NoneType'
2023-11-16 08:13:34 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_9"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_9_1" aria-expanded="false" aria-controls="job_list___sub_collapse_9_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_9_1"><button class="btn btn-outline-success"><span class="job_id">9 : Job ID c161ed4029334749a6c80d6bbad9fc32</span></button></div></a><div aria-labelledby="job_list___sub_heading_9_1" data-parent="#job_list___sub_accordion_9" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_9_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Sub, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str - None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str - None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for -: 'type' and 'NoneType'
2023-11-16 08:13:35 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_10"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_10_1" aria-expanded="false" aria-controls="job_list___sub_collapse_10_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_10_1"><button class="btn btn-outline-success"><span class="job_id">10 : Job ID 291abe3080934fcfaaed31559df31618</span></button></div></a><div aria-labelledby="job_list___sub_heading_10_1" data-parent="#job_list___sub_accordion_10" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_10_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Sub, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str - None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str - None) -&gt; None:
E   TypeError: unsupported operand type(s) for -: 'type' and 'NoneType'
2023-11-16 08:13:37 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_11"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_11_1" aria-expanded="false" aria-controls="job_list___sub_collapse_11_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_11_1"><button class="btn btn-outline-success"><span class="job_id">11 : Job ID b4f4c570e61d432fa332290d65ea254a</span></button></div></a><div aria-labelledby="job_list___sub_heading_11_1" data-parent="#job_list___sub_accordion_11" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_11_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Mul, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str * None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str * None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for *: 'type' and 'NoneType'
2023-11-16 08:13:38 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_12"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_12_1" aria-expanded="false" aria-controls="job_list___sub_collapse_12_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_12_1"><button class="btn btn-outline-success"><span class="job_id">12 : Job ID 3e8e26667c314725ad683f3f30f8165a</span></button></div></a><div aria-labelledby="job_list___sub_heading_12_1" data-parent="#job_list___sub_accordion_12" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_12_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Mul, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str * None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str * None) -&gt; None:
E   TypeError: unsupported operand type(s) for *: 'type' and 'NoneType'
2023-11-16 08:13:39 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_13"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_13_1" aria-expanded="false" aria-controls="job_list___sub_collapse_13_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_13_1"><button class="btn btn-outline-success"><span class="job_id">13 : Job ID ffdb4d2346c240f19682888c7b62fe60</span></button></div></a><div aria-labelledby="job_list___sub_heading_13_1" data-parent="#job_list___sub_accordion_13" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_13_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Div, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str / None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str / None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for /: 'type' and 'NoneType'
2023-11-16 08:13:40 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_14"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_14_1" aria-expanded="false" aria-controls="job_list___sub_collapse_14_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_14_1"><button class="btn btn-outline-success"><span class="job_id">14 : Job ID ef67385e9dad496ea952daec10c4a756</span></button></div></a><div aria-labelledby="job_list___sub_heading_14_1" data-parent="#job_list___sub_accordion_14" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_14_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Div, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str / None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str / None) -&gt; None:
E   TypeError: unsupported operand type(s) for /: 'type' and 'NoneType'
2023-11-16 08:13:41 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_15"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_15_1" aria-expanded="false" aria-controls="job_list___sub_collapse_15_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_15_1"><button class="btn btn-outline-success"><span class="job_id">15 : Job ID 5cd324f158824c069f22f542830ea911</span></button></div></a><div aria-labelledby="job_list___sub_heading_15_1" data-parent="#job_list___sub_accordion_15" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_15_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_FloorDiv, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str // None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str // None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for //: 'type' and 'NoneType'
2023-11-16 08:13:43 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_16"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_16_1" aria-expanded="false" aria-controls="job_list___sub_collapse_16_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_16_1"><button class="btn btn-outline-success"><span class="job_id">16 : Job ID b35255fa1c814966acdef9ada0ee7196</span></button></div></a><div aria-labelledby="job_list___sub_heading_16_1" data-parent="#job_list___sub_accordion_16" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_16_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_FloorDiv, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str // None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str // None) -&gt; None:
E   TypeError: unsupported operand type(s) for //: 'type' and 'NoneType'
2023-11-16 08:13:44 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_17"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_17_1" aria-expanded="false" aria-controls="job_list___sub_collapse_17_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_17_1"><button class="btn btn-outline-success"><span class="job_id">17 : Job ID 916986ba69c148ee9b571fd7d8e45567</span></button></div></a><div aria-labelledby="job_list___sub_heading_17_1" data-parent="#job_list___sub_accordion_17" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_17_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Mod, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str % None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str % None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for %: 'type' and 'NoneType'
2023-11-16 08:13:45 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_18"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_18_1" aria-expanded="false" aria-controls="job_list___sub_collapse_18_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_18_1"><button class="btn btn-outline-success"><span class="job_id">18 : Job ID e6aacfa1273241139291ebb7b80a529f</span></button></div></a><div aria-labelledby="job_list___sub_heading_18_1" data-parent="#job_list___sub_accordion_18" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_18_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Mod, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str % None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str % None) -&gt; None:
E   TypeError: unsupported operand type(s) for %: 'type' and 'NoneType'
2023-11-16 08:13:46 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_19"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_19_1" aria-expanded="false" aria-controls="job_list___sub_collapse_19_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_19_1"><button class="btn btn-outline-success"><span class="job_id">19 : Job ID ec928967b5294338bc1e3e4fc52c666b</span></button></div></a><div aria-labelledby="job_list___sub_heading_19_1" data-parent="#job_list___sub_accordion_19" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_19_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Pow, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str ** None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str ** None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for ** or pow(): 'type' and 'NoneType'
2023-11-16 08:13:47 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_20"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_20_1" aria-expanded="false" aria-controls="job_list___sub_collapse_20_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_20_1"><button class="btn btn-outline-success"><span class="job_id">20 : Job ID 4956d50011694f5a86ea41b198136c76</span></button></div></a><div aria-labelledby="job_list___sub_heading_20_1" data-parent="#job_list___sub_accordion_20" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_20_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Pow, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str ** None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str ** None) -&gt; None:
E   TypeError: unsupported operand type(s) for ** or pow(): 'type' and 'NoneType'
2023-11-16 08:13:49 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_21"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_21_1" aria-expanded="false" aria-controls="job_list___sub_collapse_21_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_21_1"><button class="btn btn-outline-success"><span class="job_id">21 : Job ID 56403a912851472d8221fb363947f1ab</span></button></div></a><div aria-labelledby="job_list___sub_heading_21_1" data-parent="#job_list___sub_accordion_21" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_21_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_RShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str &gt;&gt; None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str &gt;&gt; None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for &gt;&gt;: 'type' and 'NoneType'
2023-11-16 08:13:50 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_22"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_22_1" aria-expanded="false" aria-controls="job_list___sub_collapse_22_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_22_1"><button class="btn btn-outline-success"><span class="job_id">22 : Job ID 7b6dcdde55fa4750a18ca308e0fb5fc8</span></button></div></a><div aria-labelledby="job_list___sub_heading_22_1" data-parent="#job_list___sub_accordion_22" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_22_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_RShift, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str &gt;&gt; None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str &gt;&gt; None) -&gt; None:
E   TypeError: unsupported operand type(s) for &gt;&gt;: 'type' and 'NoneType'
2023-11-16 08:13:51 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_23"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_23_1" aria-expanded="false" aria-controls="job_list___sub_collapse_23_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_23_1"><button class="btn btn-outline-success"><span class="job_id">23 : Job ID 43791dd6bdeb40b082be6425785cd581</span></button></div></a><div aria-labelledby="job_list___sub_heading_23_1" data-parent="#job_list___sub_accordion_23" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_23_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_LShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str &lt;&lt; None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str &lt;&lt; None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for &lt;&lt;: 'type' and 'NoneType'
2023-11-16 08:13:52 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_24"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_24_1" aria-expanded="false" aria-controls="job_list___sub_collapse_24_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_24_1"><button class="btn btn-outline-success"><span class="job_id">24 : Job ID abda943d4b9948f997203b3fc7e8fa00</span></button></div></a><div aria-labelledby="job_list___sub_heading_24_1" data-parent="#job_list___sub_accordion_24" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_24_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_LShift, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str &lt;&lt; None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str &lt;&lt; None) -&gt; None:
E   TypeError: unsupported operand type(s) for &lt;&lt;: 'type' and 'NoneType'
2023-11-16 08:13:53 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_25"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_25_1" aria-expanded="false" aria-controls="job_list___sub_collapse_25_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_25_1"><button class="btn btn-outline-success"><span class="job_id">25 : Job ID 5851ea445f234bc89d44e8324d2223d9</span></button></div></a><div aria-labelledby="job_list___sub_heading_25_1" data-parent="#job_list___sub_accordion_25" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_25_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_BitAnd, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str &amp; None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str &amp; None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for &amp;: 'type' and 'NoneType'
2023-11-16 08:13:55 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_26"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_26_1" aria-expanded="false" aria-controls="job_list___sub_collapse_26_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_26_1"><button class="btn btn-outline-success"><span class="job_id">26 : Job ID ef8e1b58499142ce8a6bd9294b1f0edd</span></button></div></a><div aria-labelledby="job_list___sub_heading_26_1" data-parent="#job_list___sub_accordion_26" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_26_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_BitAnd, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str &amp; None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str &amp; None) -&gt; None:
E   TypeError: unsupported operand type(s) for &amp;: 'type' and 'NoneType'
2023-11-16 08:13:56 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_27"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_27_1" aria-expanded="false" aria-controls="job_list___sub_collapse_27_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_27_1"><button class="btn btn-outline-success"><span class="job_id">27 : Job ID 29c7b252a6b342d789e7b48a80cf4b2e</span></button></div></a><div aria-labelledby="job_list___sub_heading_27_1" data-parent="#job_list___sub_accordion_27" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_27_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 36), end pos: (5, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_BitXor, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str ^ None, user_ik: str | None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str ^ None, user_ik: str | None) -&gt; None:
E   TypeError: unsupported operand type(s) for ^: 'type' and 'NoneType'
2023-11-16 08:13:57 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_28"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_28_1" aria-expanded="false" aria-controls="job_list___sub_collapse_28_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_28_1"><button class="btn btn-outline-success"><span class="job_id">28 : Job ID 8e9d5af431094df792e2e4a73cf5bf9a</span></button></div></a><div aria-labelledby="job_list___sub_heading_28_1" data-parent="#job_list___sub_accordion_28" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_28_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=5" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (5, 57), end pos: (5, 58)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_BitXor, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -2,7 +2,7 @@
 
 
 class User(UserMixin):
-    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
+    def __init__(self, user_id: str | None, user_ik: str ^ None) -&gt; None:
         if user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:14: in &lt;module&gt;
    from app.authentication.user import User
app/authentication/user.py:4: in &lt;module&gt;
    class User(UserMixin):
app/authentication/user.py:5: in User
    def __init__(self, user_id: str | None, user_ik: str ^ None) -&gt; None:
E   TypeError: unsupported operand type(s) for ^: 'type' and 'NoneType'
2023-11-16 08:13:58 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_29"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_29_1" aria-expanded="false" aria-controls="job_list___sub_collapse_29_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_29_1"><button class="btn btn-outline-success"><span class="job_id">29 : Job ID 1610e00ed5c94fc486d2fd191d32f57f</span></button></div></a><div aria-labelledby="job_list___sub_heading_29_1" data-parent="#job_list___sub_accordion_29" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_29_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=6" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (6, 11), end pos: (6, 30)</button></a></pre><pre>operator: core/AddNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -3,7 +3,7 @@
 
 class User(UserMixin):
     def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
-        if user_id and user_ik:
+        if not user_id and user_ik:
             self.user_id = user_id
             self.user_ik = user_ik
         else:</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

........................F.F.FFFF.F..FF                                   [100%]2023-11-16 08:13:59 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:00 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
________________________________ test_none_user ________________________________
[gw6] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_none_user():
&gt;       with pytest.raises(ValueError):
E       Failed: DID NOT RAISE &lt;class 'ValueError'&gt;

tests/app/authentication/test_user.py:27: Failed
_______________________________ test_get_user_ik _______________________________
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_get_user_ik():
&gt;       user = User("1", "2")

tests/app/authentication/test_user.py:12: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x10c83cd90&gt;, user_id = '1'
user_ik = '2'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
______________________________ test_negative_user ______________________________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_negative_user():
&gt;       user = User("-1", "2")

tests/app/authentication/test_user.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x10f4befd0&gt;, user_id = '-1'
user_ik = '2'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x109d6b0d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x109d6a550&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 8, 487825, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x109d489d0&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = load_user()

tests/app/authentication/test_authenticator.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:111: in load_user
    user = User(user_id, user_ik)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x109366e90&gt;, user_id = 'user_id'
user_ik = 'user_ik'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:03 [debug    ] session exists
_______________________________ test_get_user_id _______________________________
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_get_user_id():
&gt;       user = User("1", "2")

tests/app/authentication/test_user.py:7: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x114381d10&gt;, user_id = '1'
user_ik = '2'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x112be10d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x112be2790&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 8, 487746, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112c0ced0&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:68: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:111: in load_user
    user = User(user_id, user_ik)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x11138ffd0&gt;, user_id = 'user_id'
user_ik = 'user_ik'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:03 [debug    ] loading user                   user_id=None
2023-11-16 08:14:03 [debug    ] session exists
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10d45f290&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10d45da10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 8, 486071, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10d3d1690&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:111: in load_user
    user = User(user_id, user_ik)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x109a11f90&gt;, user_id = 'user_id'
user_ik = 'user_ik'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:03 [debug    ] loading user                   user_id=None
2023-11-16 08:14:03 [debug    ] session exists
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x112ccbcd0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x112ccb690&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 8, 736318, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112c0e790&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:48: in request_load_user
    return load_user(extend_session=extend_session)
app/authentication/authenticator.py:111: in load_user
    user = User(user_id, user_ik)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x1129eaf50&gt;, user_id = 'user_id'
user_ik = 'user_ik'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:03 [debug    ] load user
2023-11-16 08:14:03 [debug    ] session exists
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x114d936d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x114d93a10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 8, 532556, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x114d89650&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:111: in load_user
    user = User(user_id, user_ik)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;app.authentication.user.User object at 0x114d00e10&gt;, user_id = 'user_id'
user_ik = 'user_ik'

    def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
        if not user_id and user_ik:
            self.user_id = user_id
            self.user_ik = user_ik
        else:
&gt;           raise ValueError("No user_id or user_ik found in session")
E           ValueError: No user_id or user_ik found in session

app/authentication/user.py:10: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:03 [debug    ] loading user                   user_id=None
2023-11-16 08:14:03 [debug    ] session exists
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_user.py::test_none_user - Failed: DID NO...
FAILED tests/app/authentication/test_user.py::test_get_user_ik - ValueError: ...
FAILED tests/app/authentication/test_user.py::test_negative_user - ValueError...
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_user.py::test_get_user_id - ValueError: ...
FAILED tests/app/authentication/test_authenticator.py::test_load_user - Value...
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 9 failed, 29 passed, 325 warnings in 3.86s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_30"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_30_1" aria-expanded="false" aria-controls="job_list___sub_collapse_30_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_30_1"><button class="btn btn-outline-success"><span class="job_id">30 : Job ID 1c07c1c0406b49bcada5d7c23c9c3370</span></button></div></a><div aria-labelledby="job_list___sub_heading_30_1" data-parent="#job_list___sub_accordion_30" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_30_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/user.py&amp;line=6" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/user.py, start pos: (6, 19), end pos: (6, 22)</button></a></pre><pre>operator: core/ReplaceAndWithOr, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/user.py
+++ bapp/authentication/user.py
@@ -3,7 +3,7 @@
 
 class User(UserMixin):
     def __init__(self, user_id: str | None, user_ik: str | None) -&gt; None:
-        if user_id and user_ik:
+        if user_id or user_ik:
             self.user_id = user_id
             self.user_ik = user_ik
         else:</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:14:05 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
________________________________ test_none_user ________________________________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_none_user():
&gt;       with pytest.raises(ValueError):
E       Failed: DID NOT RAISE &lt;class 'ValueError'&gt;

tests/app/authentication/test_user.py:27: Failed
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_user.py::test_none_user - Failed: DID NO...
================== 1 failed, 37 passed, 325 warnings in 3.73s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_31"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_31_1" aria-expanded="false" aria-controls="job_list___sub_collapse_31_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_31_1"><button class="btn btn-outline-success"><span class="job_id">31 : Job ID c4925042c78c4620a7969b8617e86baf</span></button></div></a><div aria-labelledby="job_list___sub_heading_31_1" data-parent="#job_list___sub_accordion_31" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_31_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_Sub, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) - timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:14:10 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:10 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x112ed9410&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x112ed93d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 18, 961222, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112e8c890&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 14, 18, 961222, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 14, 18, 961222, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 14, 18, 961222, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x112ed9410&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:13 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:13 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:13 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:13 [debug    ] loading user                   user_id=None
2023-11-16 08:14:13 [debug    ] session exists
2023-11-16 08:14:13 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
================== 1 failed, 37 passed, 325 warnings in 3.92s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_32"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_32_1" aria-expanded="false" aria-controls="job_list___sub_collapse_32_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_32_1"><button class="btn btn-outline-success"><span class="job_id">32 : Job ID 00724996ede048e0899849c4d037682f</span></button></div></a><div aria-labelledby="job_list___sub_heading_32_1" data-parent="#job_list___sub_accordion_32" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_32_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_Mul, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) * timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:15 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:16 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10eaca450&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10ea9d650&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 24, 237898, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10eaae750&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10eaca450&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) * timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for *: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:19 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:19 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:19 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:19 [debug    ] loading user                   user_id=None
2023-11-16 08:14:19 [debug    ] session exists
2023-11-16 08:14:19 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10781e410&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10781ead0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 24, 268655, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x107851550&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10781e410&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) * timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for *: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:19 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:19 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:19 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:19 [debug    ] loading user                   user_id=None
2023-11-16 08:14:19 [debug    ] session exists
2023-11-16 08:14:19 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.87s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_33"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_33_1" aria-expanded="false" aria-controls="job_list___sub_collapse_33_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_33_1"><button class="btn btn-outline-success"><span class="job_id">33 : Job ID ad5d6fe266ea4b96bbfb884f3e6cdde9</span></button></div></a><div aria-labelledby="job_list___sub_heading_33_1" data-parent="#job_list___sub_accordion_33" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_33_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_Div, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) / timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:20 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:21 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1101f6590&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1101f5c10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 29, 617259, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x11017d7d0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1101f6590&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) / timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for /: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:24 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:24 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:24 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:24 [debug    ] loading user                   user_id=None
2023-11-16 08:14:24 [debug    ] session exists
2023-11-16 08:14:24 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1102bb2d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1102bb7d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 29, 648686, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1102ad6d0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1102bb2d0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) / timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for /: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:24 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:24 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:24 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:24 [debug    ] loading user                   user_id=None
2023-11-16 08:14:24 [debug    ] session exists
2023-11-16 08:14:24 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.92s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_34"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_34_1" aria-expanded="false" aria-controls="job_list___sub_collapse_34_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_34_1"><button class="btn btn-outline-success"><span class="job_id">34 : Job ID 12eebe8a25434370b5ab8df631dac41f</span></button></div></a><div aria-labelledby="job_list___sub_heading_34_1" data-parent="#job_list___sub_accordion_34" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_34_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_FloorDiv, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) // timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:26 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:26 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1072f6950&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1072f46d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 34, 978569, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1072e4150&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1072f6950&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) // timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for //: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:29 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:29 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:29 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:29 [debug    ] loading user                   user_id=None
2023-11-16 08:14:29 [debug    ] session exists
2023-11-16 08:14:29 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x109536150&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x109537850&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 35, 7228, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10955dd90&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x109536150&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) // timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for //: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:29 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:30 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:30 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:30 [debug    ] loading user                   user_id=None
2023-11-16 08:14:30 [debug    ] session exists
2023-11-16 08:14:30 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.91s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_35"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_35_1" aria-expanded="false" aria-controls="job_list___sub_collapse_35_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_35_1"><button class="btn btn-outline-success"><span class="job_id">35 : Job ID 339c8b24ba634cbf91af53281788fc64</span></button></div></a><div aria-labelledby="job_list___sub_heading_35_1" data-parent="#job_list___sub_accordion_35" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_35_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_Mod, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) % timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:31 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:32 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x11202a550&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1120299d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 40, 424904, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112065bd0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x11202a550&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) % timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for %: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:35 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:35 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:35 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:35 [debug    ] loading user                   user_id=None
2023-11-16 08:14:35 [debug    ] session exists
2023-11-16 08:14:35 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1094df150&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1094df610&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 40, 455583, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1094d56d0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1094df150&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) % timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for %: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:35 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:35 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:35 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:35 [debug    ] loading user                   user_id=None
2023-11-16 08:14:35 [debug    ] session exists
2023-11-16 08:14:35 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.06s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_36"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_36_1" aria-expanded="false" aria-controls="job_list___sub_collapse_36_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_36_1"><button class="btn btn-outline-success"><span class="job_id">36 : Job ID 720080ab618f47e49bea2d4760c33aef</span></button></div></a><div aria-labelledby="job_list___sub_heading_36_1" data-parent="#job_list___sub_accordion_36" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_36_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_Pow, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) ** timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:37 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:37 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x111027f90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x110debd10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 46, 5185, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x111015650&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x111027f90&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) ** timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for ** or pow(): 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:40 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:41 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:41 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:41 [debug    ] loading user                   user_id=None
2023-11-16 08:14:41 [debug    ] session exists
2023-11-16 08:14:41 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1062c3510&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1062c3410&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 46, 48038, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1062b90d0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1062c3510&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) ** timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for ** or pow(): 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:41 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:41 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:41 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:41 [debug    ] loading user                   user_id=None
2023-11-16 08:14:41 [debug    ] session exists
2023-11-16 08:14:41 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.18s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_37"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_37_1" aria-expanded="false" aria-controls="job_list___sub_collapse_37_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_37_1"><button class="btn btn-outline-success"><span class="job_id">37 : Job ID 0066e1c1d62545fca2206e92b790dd32</span></button></div></a><div aria-labelledby="job_list___sub_heading_37_1" data-parent="#job_list___sub_accordion_37" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_37_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_RShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) &gt;&gt; timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:42 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:43 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1081f9450&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1081b1810&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 51, 651683, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x108180fd0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1081f9450&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) &gt;&gt; timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for &gt;&gt;: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:46 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:46 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:46 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:46 [debug    ] loading user                   user_id=None
2023-11-16 08:14:46 [debug    ] session exists
2023-11-16 08:14:46 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x108317750&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x108317a90&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 51, 685651, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x108325ad0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x108317750&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) &gt;&gt; timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for &gt;&gt;: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:46 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:46 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:46 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:46 [debug    ] loading user                   user_id=None
2023-11-16 08:14:46 [debug    ] session exists
2023-11-16 08:14:46 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.12s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_38"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_38_1" aria-expanded="false" aria-controls="job_list___sub_collapse_38_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_38_1"><button class="btn btn-outline-success"><span class="job_id">38 : Job ID 7e82ed8d19304859b05f98af55be45d3</span></button></div></a><div aria-labelledby="job_list___sub_heading_38_1" data-parent="#job_list___sub_accordion_38" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_38_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_LShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) &lt;&lt; timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:48 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:48 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10c8f67d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10c8f4150&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 57, 310709, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10c90eb50&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10c8f67d0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) &lt;&lt; timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for &lt;&lt;: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:52 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:52 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:52 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:52 [debug    ] loading user                   user_id=None
2023-11-16 08:14:52 [debug    ] session exists
2023-11-16 08:14:52 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1110f2750&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1110f2c10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 14, 57, 342508, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1110ece90&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1110f2750&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) &lt;&lt; timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for &lt;&lt;: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:52 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:52 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:52 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:52 [debug    ] loading user                   user_id=None
2023-11-16 08:14:52 [debug    ] session exists
2023-11-16 08:14:52 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.20s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_39"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_39_1" aria-expanded="false" aria-controls="job_list___sub_collapse_39_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_39_1"><button class="btn btn-outline-success"><span class="job_id">39 : Job ID f9787c736b324609b85e6e0966bc2c1b</span></button></div></a><div aria-labelledby="job_list___sub_heading_39_1" data-parent="#job_list___sub_accordion_39" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_39_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_BitOr, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) | timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:53 [debug    ] reading from file              filename=.application-version
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:14:54 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10a7ea910&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10a8603d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 2, 797099, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10a874990&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10a7ea910&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) | timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for |: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:57 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:57 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:57 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:57 [debug    ] loading user                   user_id=None
2023-11-16 08:14:57 [debug    ] session exists
2023-11-16 08:14:57 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1075b3750&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1075b3c10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 2, 828049, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1075add90&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1075b3750&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) | timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for |: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:14:57 [info     ] starting eq survey runner      version=local

2023-11-16 08:14:57 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:14:57 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:14:57 [debug    ] loading user                   user_id=None
2023-11-16 08:14:57 [debug    ] session exists
2023-11-16 08:14:57 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.08s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_40"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_40_1" aria-expanded="false" aria-controls="job_list___sub_collapse_40_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_40_1"><button class="btn btn-outline-success"><span class="job_id">40 : Job ID d7fddf2527fa46578f78f05303d7d99e</span></button></div></a><div aria-labelledby="job_list___sub_heading_40_1" data-parent="#job_list___sub_accordion_40" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_40_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_BitAnd, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) &amp; timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:14:59 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:00 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10ad1de90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10ad1fad0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 8, 365445, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10ad5e1d0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10ad1de90&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) &amp; timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for &amp;: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:03 [debug    ] loading user                   user_id=None
2023-11-16 08:15:03 [debug    ] session exists
2023-11-16 08:15:03 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x110ddf010&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x110ddf510&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 8, 395950, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x110e11290&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x110ddf010&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) &amp; timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for &amp;: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:03 [debug    ] loading user                   user_id=None
2023-11-16 08:15:03 [debug    ] session exists
2023-11-16 08:15:03 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.10s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_41"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_41_1" aria-expanded="false" aria-controls="job_list___sub_collapse_41_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_41_1"><button class="btn btn-outline-success"><span class="job_id">41 : Job ID be83dfd3634c4af2a20440134c711f31</span></button></div></a><div aria-labelledby="job_list___sub_heading_41_1" data-parent="#job_list___sub_accordion_41" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_41_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=69" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (69, 60), end pos: (69, 61)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Add_BitXor, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -66,7 +66,7 @@
     """
     session_timeout = cookie_session.get("expires_in")
     if session_timeout:
-        new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
+        new_expiration_time = datetime.now(tz=timezone.utc) ^ timedelta(
             seconds=session_timeout
         )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:05 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1092cf490&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1092ce9d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 13, 842811, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10929ba10&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1092cf490&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) ^ timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for ^: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:08 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:08 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:08 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:08 [debug    ] loading user                   user_id=None
2023-11-16 08:15:08 [debug    ] session exists
2023-11-16 08:15:08 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x112db9850&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x112dbaf50&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 13, 873771, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112da9550&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x112db9850&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) ^ timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported operand type(s) for ^: 'datetime.datetime' and 'datetime.timedelta'

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:08 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:08 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:08 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:08 [debug    ] loading user                   user_id=None
2023-11-16 08:15:08 [debug    ] session exists
2023-11-16 08:15:08 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.01s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_42"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_42_1" aria-expanded="false" aria-controls="job_list___sub_collapse_42_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_42_1"><button class="btn btn-outline-success"><span class="job_id">42 : Job ID a3f152b794c1445fae405604d5171766</span></button></div></a><div aria-labelledby="job_list___sub_heading_42_1" data-parent="#job_list___sub_accordion_42" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_42_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_Add, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time + session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:10 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:11 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x112ef3a10&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x112ef2a50&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 19, 238739, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112f0ec90&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x112ef3a10&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time + session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for +: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:14 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:14 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:14 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:14 [debug    ] loading user                   user_id=None
2023-11-16 08:15:14 [debug    ] session exists
2023-11-16 08:15:14 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x114193ed0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1141840d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 19, 269675, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1141ce010&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x114193ed0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time + session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for +: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:14 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:14 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:14 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:14 [debug    ] loading user                   user_id=None
2023-11-16 08:15:14 [debug    ] session exists
2023-11-16 08:15:14 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.12s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_43"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_43_1" aria-expanded="false" aria-controls="job_list___sub_collapse_43_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_43_1"><button class="btn btn-outline-success"><span class="job_id">43 : Job ID 578fe0c033934d2996e329ff6a2b0205</span></button></div></a><div aria-labelledby="job_list___sub_heading_43_1" data-parent="#job_list___sub_accordion_43" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_43_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_Mul, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time * session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:16 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:16 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x114f64810&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x114f647d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 24, 984455, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x115033d90&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x114f64810&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time * session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for *: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:19 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:19 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:19 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:19 [debug    ] loading user                   user_id=None
2023-11-16 08:15:19 [debug    ] session exists
2023-11-16 08:15:19 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x111be6d90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x111be7250&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 25, 17045, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x111ba9750&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x111be6d90&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time * session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for *: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:19 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:20 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:20 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:20 [debug    ] loading user                   user_id=None
2023-11-16 08:15:20 [debug    ] session exists
2023-11-16 08:15:20 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.15s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_44"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_44_1" aria-expanded="false" aria-controls="job_list___sub_collapse_44_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_44_1"><button class="btn btn-outline-success"><span class="job_id">44 : Job ID 7d91a0974e554ff3be58319a7cf63e33</span></button></div></a><div aria-labelledby="job_list___sub_heading_44_1" data-parent="#job_list___sub_accordion_44" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_44_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_Div, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time / session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:21 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:22 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x109009490&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10907c1d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 30, 414436, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10905f4d0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x109009490&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time / session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for /: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:25 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:25 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:25 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:25 [debug    ] loading user                   user_id=None
2023-11-16 08:15:25 [debug    ] session exists
2023-11-16 08:15:25 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x112d27050&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x112d27550&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 30, 441826, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112d1d510&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x112d27050&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time / session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for /: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:25 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:25 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:25 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:25 [debug    ] loading user                   user_id=None
2023-11-16 08:15:25 [debug    ] session exists
2023-11-16 08:15:25 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.91s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_45"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_45_1" aria-expanded="false" aria-controls="job_list___sub_collapse_45_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_45_1"><button class="btn btn-outline-success"><span class="job_id">45 : Job ID 022ac2bbfda94232ba098ae8232ec461</span></button></div></a><div aria-labelledby="job_list___sub_heading_45_1" data-parent="#job_list___sub_accordion_45" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_45_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_FloorDiv, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time // session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:27 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:27 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10be279d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10be25790&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 35, 716216, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10bd9bd10&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10be279d0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time // session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for //: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:30 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:30 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:30 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:30 [debug    ] loading user                   user_id=None
2023-11-16 08:15:30 [debug    ] session exists
2023-11-16 08:15:30 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x110dfaf10&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x110dfb310&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 35, 746042, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x110e35a10&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x110dfaf10&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time // session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for //: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:30 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:30 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:30 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:30 [debug    ] loading user                   user_id=None
2023-11-16 08:15:30 [debug    ] session exists
2023-11-16 08:15:30 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.93s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_46"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_46_1" aria-expanded="false" aria-controls="job_list___sub_collapse_46_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_46_1"><button class="btn btn-outline-success"><span class="job_id">46 : Job ID 97df078fcff7401bb61a979963b757e0</span></button></div></a><div aria-labelledby="job_list___sub_heading_46_1" data-parent="#job_list___sub_accordion_46" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_46_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_Mod, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time % session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:32 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:33 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x113d60450&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x113d1ef90&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 41, 236308, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x113d609d0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x113d60450&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time % session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for %: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:36 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:36 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:36 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:36 [debug    ] loading user                   user_id=None
2023-11-16 08:15:36 [debug    ] session exists
2023-11-16 08:15:36 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x111a0ad90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x111a0b290&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 41, 267761, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x111a3ced0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x111a0ad90&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time % session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for %: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:36 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:36 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:36 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:36 [debug    ] loading user                   user_id=None
2023-11-16 08:15:36 [debug    ] session exists
2023-11-16 08:15:36 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.09s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_47"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_47_1" aria-expanded="false" aria-controls="job_list___sub_collapse_47_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_47_1"><button class="btn btn-outline-success"><span class="job_id">47 : Job ID 0f2b76fd22c34d1c9445eed987126c1a</span></button></div></a><div aria-labelledby="job_list___sub_heading_47_1" data-parent="#job_list___sub_accordion_47" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_47_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_Pow, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time ** session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:38 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:38 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x11409d110&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x11409f7d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 46, 729554, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x114167b90&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x11409d110&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time ** session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for ** or pow(): 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:41 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:41 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:41 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:41 [debug    ] loading user                   user_id=None
2023-11-16 08:15:41 [debug    ] session exists
2023-11-16 08:15:41 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x109953790&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x109953690&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 46, 757670, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10999d390&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x109953790&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time ** session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for ** or pow(): 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:41 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:41 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:41 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:41 [debug    ] loading user                   user_id=None
2023-11-16 08:15:41 [debug    ] session exists
2023-11-16 08:15:41 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.89s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_48"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_48_1" aria-expanded="false" aria-controls="job_list___sub_collapse_48_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_48_1"><button class="btn btn-outline-success"><span class="job_id">48 : Job ID 8e5166ee76fd411aa0b0d003634b1576</span></button></div></a><div aria-labelledby="job_list___sub_heading_48_1" data-parent="#job_list___sub_accordion_48" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_48_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_RShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time &gt;&gt; session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:43 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:44 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1092ce2d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1092ceb10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 52, 514733, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10933ab10&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1092ce2d0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time &gt;&gt; session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for &gt;&gt;: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:47 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:47 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:47 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:47 [debug    ] loading user                   user_id=None
2023-11-16 08:15:47 [debug    ] session exists
2023-11-16 08:15:47 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1056c2c90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1056c1c50&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 52, 554922, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1056bd950&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1056c2c90&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time &gt;&gt; session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for &gt;&gt;: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:47 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:47 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:47 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:47 [debug    ] loading user                   user_id=None
2023-11-16 08:15:47 [debug    ] session exists
2023-11-16 08:15:47 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.34s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_49"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_49_1" aria-expanded="false" aria-controls="job_list___sub_collapse_49_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_49_1"><button class="btn btn-outline-success"><span class="job_id">49 : Job ID 29581b5cfeaa471bad2f4c1ce0177e4b</span></button></div></a><div aria-labelledby="job_list___sub_heading_49_1" data-parent="#job_list___sub_accordion_49" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_49_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_LShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time &lt;&lt; session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:49 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:49 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10b6026d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10b7f1f90&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 57, 925537, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10b83ff90&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10b6026d0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time &lt;&lt; session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for &lt;&lt;: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:52 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:52 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:52 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:52 [debug    ] loading user                   user_id=None
2023-11-16 08:15:52 [debug    ] session exists
2023-11-16 08:15:52 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10ccd83d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10ccd85d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 15, 57, 954348, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10cce1e50&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10ccd83d0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time &lt;&lt; session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for &lt;&lt;: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:52 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:52 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:52 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:52 [debug    ] loading user                   user_id=None
2023-11-16 08:15:52 [debug    ] session exists
2023-11-16 08:15:52 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.86s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_50"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_50_1" aria-expanded="false" aria-controls="job_list___sub_collapse_50_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_50_1"><button class="btn btn-outline-success"><span class="job_id">50 : Job ID 18dab043133843d3bb1ce19bfbe5461c</span></button></div></a><div aria-labelledby="job_list___sub_heading_50_1" data-parent="#job_list___sub_accordion_50" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_50_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_BitOr, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time | session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:54 [debug    ] reading from file              filename=.application-version
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:15:55 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x104e1a250&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x104ac0710&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 3, 162969, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x106db9850&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x104e1a250&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time | session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for |: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:58 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:58 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:58 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:58 [debug    ] loading user                   user_id=None
2023-11-16 08:15:58 [debug    ] session exists
2023-11-16 08:15:58 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1101af7d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1101afcd0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 3, 193484, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x11019d910&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1101af7d0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time | session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for |: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:15:58 [info     ] starting eq survey runner      version=local

2023-11-16 08:15:58 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:15:58 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:15:58 [debug    ] loading user                   user_id=None
2023-11-16 08:15:58 [debug    ] session exists
2023-11-16 08:15:58 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.81s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_51"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_51_1" aria-expanded="false" aria-controls="job_list___sub_collapse_51_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_51_1"><button class="btn btn-outline-success"><span class="job_id">51 : Job ID 543ae4c5b326431ba211e2b010e3597a</span></button></div></a><div aria-labelledby="job_list___sub_heading_51_1" data-parent="#job_list___sub_accordion_51" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_51_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_BitAnd, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time &amp; session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:15:59 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:00 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10d309490&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10d384fd0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 8, 378224, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10d349310&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10d309490&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time &amp; session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for &amp;: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:16:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:16:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:16:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:16:03 [debug    ] loading user                   user_id=None
2023-11-16 08:16:03 [debug    ] session exists
2023-11-16 08:16:03 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f3b8ad0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10f3b8f90&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 8, 410834, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f3b1a90&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f3b8ad0&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time &amp; session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for &amp;: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:16:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:16:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:16:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:16:03 [debug    ] loading user                   user_id=None
2023-11-16 08:16:03 [debug    ] session exists
2023-11-16 08:16:03 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.84s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_52"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_52_1" aria-expanded="false" aria-controls="job_list___sub_collapse_52_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_52_1"><button class="btn btn-outline-success"><span class="job_id">52 : Job ID d2b735bd2f90439abe1d53e1dd6a471d</span></button></div></a><div aria-labelledby="job_list___sub_heading_52_1" data-parent="#job_list___sub_accordion_52" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_52_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 36), end pos: (76, 37)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_Sub_BitXor, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            or (new_expiration_time ^ session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:16:05 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1064a3090&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1064a3190&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 13, 848299, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x106445b90&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:169: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1064a3090&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time ^ session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for ^: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:16:08 [info     ] starting eq survey runner      version=local

2023-11-16 08:16:08 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:16:08 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:16:08 [debug    ] loading user                   user_id=None
2023-11-16 08:16:08 [debug    ] session exists
2023-11-16 08:16:08 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x11227ea50&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x11227da10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 13, 879740, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1122a1250&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x11227ea50&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if session_timeout:
            new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
    
            # Only update expiry time if its greater than 60s different to what is currently set
            if (
                not session_store.expiration_time
&gt;               or (new_expiration_time ^ session_store.expiration_time).total_seconds()
                &gt; 60
            ):
E           TypeError: unsupported operand type(s) for ^: 'datetime.datetime' and 'datetime.datetime'

app/authentication/authenticator.py:76: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:16:08 [info     ] starting eq survey runner      version=local

2023-11-16 08:16:08 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:16:08 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:16:08 [debug    ] loading user                   user_id=None
2023-11-16 08:16:08 [debug    ] session exists
2023-11-16 08:16:08 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 4.15s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_53"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_53_1" aria-expanded="false" aria-controls="job_list___sub_collapse_53_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_53_1"><button class="btn btn-outline-success"><span class="job_id">53 : Job ID 258950e4010b463ab5f4d6b4ade13504</span></button></div></a><div aria-labelledby="job_list___sub_heading_53_1" data-parent="#job_list___sub_accordion_53" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_53_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Add, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str + None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str + None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for +: 'type' and 'NoneType'
2023-11-16 08:16:10 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_54"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_54_1" aria-expanded="false" aria-controls="job_list___sub_collapse_54_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_54_1"><button class="btn btn-outline-success"><span class="job_id">54 : Job ID ffb6bc940aa24d49b6a41dc5eb008078</span></button></div></a><div aria-labelledby="job_list___sub_heading_54_1" data-parent="#job_list___sub_accordion_54" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_54_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Sub, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str - None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str - None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for -: 'type' and 'NoneType'
2023-11-16 08:16:11 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_55"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_55_1" aria-expanded="false" aria-controls="job_list___sub_collapse_55_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_55_1"><button class="btn btn-outline-success"><span class="job_id">55 : Job ID 0d9a85f7a8c7436faad849a6fc3ef0e9</span></button></div></a><div aria-labelledby="job_list___sub_heading_55_1" data-parent="#job_list___sub_accordion_55" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_55_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Mul, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str * None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str * None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for *: 'type' and 'NoneType'
2023-11-16 08:16:13 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_56"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_56_1" aria-expanded="false" aria-controls="job_list___sub_collapse_56_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_56_1"><button class="btn btn-outline-success"><span class="job_id">56 : Job ID 0ed8bb5cf11e4f468d14404ec8cdf0ad</span></button></div></a><div aria-labelledby="job_list___sub_heading_56_1" data-parent="#job_list___sub_accordion_56" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_56_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Div, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str / None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str / None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for /: 'type' and 'NoneType'
2023-11-16 08:16:14 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_57"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_57_1" aria-expanded="false" aria-controls="job_list___sub_collapse_57_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_57_1"><button class="btn btn-outline-success"><span class="job_id">57 : Job ID 137a715feecb43638c84b93cb977c2e6</span></button></div></a><div aria-labelledby="job_list___sub_heading_57_1" data-parent="#job_list___sub_accordion_57" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_57_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_FloorDiv, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str // None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str // None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for //: 'type' and 'NoneType'
2023-11-16 08:16:15 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_58"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_58_1" aria-expanded="false" aria-controls="job_list___sub_collapse_58_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_58_1"><button class="btn btn-outline-success"><span class="job_id">58 : Job ID ca2b7f9b9ff34c448df01eb19587e758</span></button></div></a><div aria-labelledby="job_list___sub_heading_58_1" data-parent="#job_list___sub_accordion_58" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_58_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Mod, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str % None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str % None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for %: 'type' and 'NoneType'
2023-11-16 08:16:17 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_59"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_59_1" aria-expanded="false" aria-controls="job_list___sub_collapse_59_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_59_1"><button class="btn btn-outline-success"><span class="job_id">59 : Job ID c82f3f03d28644de9fbcd5cc379c9ece</span></button></div></a><div aria-labelledby="job_list___sub_heading_59_1" data-parent="#job_list___sub_accordion_59" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_59_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_Pow, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str ** None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str ** None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for ** or pow(): 'type' and 'NoneType'
2023-11-16 08:16:18 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_60"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_60_1" aria-expanded="false" aria-controls="job_list___sub_collapse_60_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_60_1"><button class="btn btn-outline-success"><span class="job_id">60 : Job ID 853c155990dd431ea123a42df86d83a2</span></button></div></a><div aria-labelledby="job_list___sub_heading_60_1" data-parent="#job_list___sub_accordion_60" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_60_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_RShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str &gt;&gt; None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str &gt;&gt; None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for &gt;&gt;: 'type' and 'NoneType'
2023-11-16 08:16:19 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_61"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_61_1" aria-expanded="false" aria-controls="job_list___sub_collapse_61_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_61_1"><button class="btn btn-outline-success"><span class="job_id">61 : Job ID 6f6f3cdff7e840c39b63cd016b123590</span></button></div></a><div aria-labelledby="job_list___sub_heading_61_1" data-parent="#job_list___sub_accordion_61" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_61_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_LShift, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str &lt;&lt; None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str &lt;&lt; None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for &lt;&lt;: 'type' and 'NoneType'
2023-11-16 08:16:20 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_62"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_62_1" aria-expanded="false" aria-controls="job_list___sub_collapse_62_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_62_1"><button class="btn btn-outline-success"><span class="job_id">62 : Job ID a43ec69f8fc842cdad7929e7d9890f3a</span></button></div></a><div aria-labelledby="job_list___sub_heading_62_1" data-parent="#job_list___sub_accordion_62" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_62_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_BitAnd, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str &amp; None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str &amp; None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for &amp;: 'type' and 'NoneType'
2023-11-16 08:16:22 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_63"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_63_1" aria-expanded="false" aria-controls="job_list___sub_collapse_63_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_63_1"><button class="btn btn-outline-success"><span class="job_id">63 : Job ID 724ec10d281844ebad4602a79fcb97d4</span></button></div></a><div aria-labelledby="job_list___sub_heading_63_1" data-parent="#job_list___sub_accordion_63" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_63_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=178" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (178, 39), end pos: (178, 40)</button></a></pre><pre>operator: core/ReplaceBinaryOperator_BitOr_BitXor, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -175,7 +175,7 @@
     logger.info("user authenticated")
 
 
-def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
+def decrypt_token(encrypted_token: str ^ None) -&gt; dict[str, Any]:
     if not encrypted_token:
         raise NoTokenException("Please provide a token")
 </pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
app/authentication/authenticator.py:178: in &lt;module&gt;
    def decrypt_token(encrypted_token: str ^ None) -&gt; dict[str, Any]:
E   TypeError: unsupported operand type(s) for ^: 'type' and 'NoneType'
2023-11-16 08:16:23 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_64"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_64_1" aria-expanded="false" aria-controls="job_list___sub_collapse_64_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_64_1"><button class="btn btn-outline-success"><span class="job_id">64 : Job ID 07e84d87bacf4eda8abde8ac75050b1c</span></button></div></a><div aria-labelledby="job_list___sub_heading_64_1" data-parent="#job_list___sub_accordion_64" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_64_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 25), end pos: (45, 27)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_NotEq, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint != "session.session_expiry" and request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:16:24 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:25 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10a944c90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10a91c250&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 33, 699364, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10a946150&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:45: in request_load_user
    request.endpoint != "session.session_expiry" and request.method == "GET"
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Mock spec='Request' id='4469996048'&gt;, name = 'method'

    def __getattr__(self, name):
        if name in {'_mock_methods', '_mock_unsafe'}:
            raise AttributeError(name)
        elif self._mock_methods is not None:
            if name not in self._mock_methods or name in _all_magics:
&gt;               raise AttributeError("Mock object has no attribute %r" % name)
E               AttributeError: Mock object has no attribute 'method'

../../.pyenv/versions/3.11.4/lib/python3.11/unittest/mock.py:653: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:16:28 [info     ] starting eq survey runner      version=local

2023-11-16 08:16:28 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:16:28 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:16:28 [debug    ] load user
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 1 failed, 37 passed, 325 warnings in 4.31s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_65"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_65_1" aria-expanded="false" aria-controls="job_list___sub_collapse_65_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_65_1"><button class="btn btn-outline-danger"><span class="job_id">65 : Job ID c9e5b5565c7f47d0817f77b1fbe44c65</span></button></div></a><div aria-labelledby="job_list___sub_heading_65_1" data-parent="#job_list___sub_accordion_65" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_65_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 72), end pos: (45, 74)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_NotEq, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" and request.method != "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:16:30 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:31 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.83s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_66"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_66_1" aria-expanded="false" aria-controls="job_list___sub_collapse_66_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_66_1"><button class="btn btn-outline-success"><span class="job_id">66 : Job ID ee430d0c56bf46bbab3fff80989eb091</span></button></div></a><div aria-labelledby="job_list___sub_heading_66_1" data-parent="#job_list___sub_accordion_66" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_66_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 25), end pos: (45, 27)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_Lt, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint &lt; "session.session_expiry" and request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:16:35 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:36 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x111e9c110&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x111e9c410&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 44, 550477, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x111e0f1d0&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

request = &lt;Mock spec='Request' id='4595448144'&gt;

    @login_manager.request_loader
    def request_load_user(
        request: Request,  # pylint: disable=unused-argument
    ) -&gt; Optional[User]:
        logger.debug("load user")
    
        extend_session = not (
&gt;           request.endpoint &lt; "session.session_expiry" and request.method == "GET"
        )
E       TypeError: '&lt;' not supported between instances of 'Mock' and 'str'

app/authentication/authenticator.py:45: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:16:39 [info     ] starting eq survey runner      version=local

2023-11-16 08:16:39 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:16:39 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:16:39 [debug    ] load user
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 1 failed, 37 passed, 325 warnings in 3.93s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_67"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_67_1" aria-expanded="false" aria-controls="job_list___sub_collapse_67_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_67_1"><button class="btn btn-outline-danger"><span class="job_id">67 : Job ID 9f8fadb9f15245cea7c817b53550f82b</span></button></div></a><div aria-labelledby="job_list___sub_heading_67_1" data-parent="#job_list___sub_accordion_67" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_67_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 72), end pos: (45, 74)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_Lt, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" and request.method &lt; "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:16:41 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:42 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 4.57s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_68"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_68_1" aria-expanded="false" aria-controls="job_list___sub_collapse_68_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_68_1"><button class="btn btn-outline-success"><span class="job_id">68 : Job ID 1f8bbdaa90b84e35a9fd306c43dfb593</span></button></div></a><div aria-labelledby="job_list___sub_heading_68_1" data-parent="#job_list___sub_accordion_68" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_68_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 25), end pos: (45, 27)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_LtE, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint &lt;= "session.session_expiry" and request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:16:47 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:48 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x114538290&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x11453c050&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 16, 56, 975894, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x11453a3d0&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

request = &lt;Mock spec='Request' id='4635260880'&gt;

    @login_manager.request_loader
    def request_load_user(
        request: Request,  # pylint: disable=unused-argument
    ) -&gt; Optional[User]:
        logger.debug("load user")
    
        extend_session = not (
&gt;           request.endpoint &lt;= "session.session_expiry" and request.method == "GET"
        )
E       TypeError: '&lt;=' not supported between instances of 'Mock' and 'str'

app/authentication/authenticator.py:45: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:16:51 [info     ] starting eq survey runner      version=local

2023-11-16 08:16:51 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:16:51 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:16:51 [debug    ] load user
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 1 failed, 37 passed, 325 warnings in 4.37s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_69"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_69_1" aria-expanded="false" aria-controls="job_list___sub_collapse_69_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_69_1"><button class="btn btn-outline-danger"><span class="job_id">69 : Job ID d1a4c06c26fc44a7bb1c8709da417e44</span></button></div></a><div aria-labelledby="job_list___sub_heading_69_1" data-parent="#job_list___sub_accordion_69" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_69_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 72), end pos: (45, 74)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_LtE, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" and request.method &lt;= "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:16:53 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:54 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.86s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_70"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_70_1" aria-expanded="false" aria-controls="job_list___sub_collapse_70_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_70_1"><button class="btn btn-outline-success"><span class="job_id">70 : Job ID c223ed747ece43b09375e7dc843dcedb</span></button></div></a><div aria-labelledby="job_list___sub_heading_70_1" data-parent="#job_list___sub_accordion_70" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_70_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 25), end pos: (45, 27)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_Gt, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint &gt; "session.session_expiry" and request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:16:59 [debug    ] reading from file              filename=.application-version
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:16:59 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1129c11d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1129c3b10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 17, 8, 157036, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x11281fa10&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

request = &lt;Mock spec='Request' id='4604669584'&gt;

    @login_manager.request_loader
    def request_load_user(
        request: Request,  # pylint: disable=unused-argument
    ) -&gt; Optional[User]:
        logger.debug("load user")
    
        extend_session = not (
&gt;           request.endpoint &gt; "session.session_expiry" and request.method == "GET"
        )
E       TypeError: '&gt;' not supported between instances of 'Mock' and 'str'

app/authentication/authenticator.py:45: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:17:03 [info     ] starting eq survey runner      version=local

2023-11-16 08:17:03 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:17:03 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:17:03 [debug    ] load user
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 1 failed, 37 passed, 325 warnings in 4.28s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_71"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_71_1" aria-expanded="false" aria-controls="job_list___sub_collapse_71_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_71_1"><button class="btn btn-outline-danger"><span class="job_id">71 : Job ID 39c7b3130e3a4169a19c954f9b8f14a8</span></button></div></a><div aria-labelledby="job_list___sub_heading_71_1" data-parent="#job_list___sub_accordion_71" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_71_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 72), end pos: (45, 74)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_Gt, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" and request.method &gt; "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:17:04 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 4.51s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_72"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_72_1" aria-expanded="false" aria-controls="job_list___sub_collapse_72_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_72_1"><button class="btn btn-outline-success"><span class="job_id">72 : Job ID 07977c12d63c4bc78c8edafcd07b988f</span></button></div></a><div aria-labelledby="job_list___sub_heading_72_1" data-parent="#job_list___sub_accordion_72" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_72_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 25), end pos: (45, 27)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_GtE, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint &gt;= "session.session_expiry" and request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:17:10 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:11 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10e9ba8d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10e99fa90&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 17, 20, 386722, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10e9b9690&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

request = &lt;Mock spec='Request' id='4539427664'&gt;

    @login_manager.request_loader
    def request_load_user(
        request: Request,  # pylint: disable=unused-argument
    ) -&gt; Optional[User]:
        logger.debug("load user")
    
        extend_session = not (
&gt;           request.endpoint &gt;= "session.session_expiry" and request.method == "GET"
        )
E       TypeError: '&gt;=' not supported between instances of 'Mock' and 'str'

app/authentication/authenticator.py:45: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:17:15 [info     ] starting eq survey runner      version=local

2023-11-16 08:17:15 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:17:15 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:17:15 [debug    ] load user
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 1 failed, 37 passed, 325 warnings in 4.58s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_73"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_73_1" aria-expanded="false" aria-controls="job_list___sub_collapse_73_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_73_1"><button class="btn btn-outline-danger"><span class="job_id">73 : Job ID efda070aa72a496f893166b9e4ffb159</span></button></div></a><div aria-labelledby="job_list___sub_heading_73_1" data-parent="#job_list___sub_accordion_73" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_73_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 72), end pos: (45, 74)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_GtE, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" and request.method &gt;= "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:17:17 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:17 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.99s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_74"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_74_1" aria-expanded="false" aria-controls="job_list___sub_collapse_74_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_74_1"><button class="btn btn-outline-danger"><span class="job_id">74 : Job ID 6edc9be22d824df5b4d5e6bb146a59a7</span></button></div></a><div aria-labelledby="job_list___sub_heading_74_1" data-parent="#job_list___sub_accordion_74" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_74_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 25), end pos: (45, 27)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_Is, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint is "session.session_expiry" and request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:17:22 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:23 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

app/authentication/authenticator.py:45: 13 warnings
  /Users/liamtoozer/eq/eq-questionnaire-runner/app/authentication/authenticator.py:45: SyntaxWarning: "is" with a literal. Did you mean "=="?
    request.endpoint is "session.session_expiry" and request.method == "GET"

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 338 warnings in 3.99s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_75"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_75_1" aria-expanded="false" aria-controls="job_list___sub_collapse_75_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_75_1"><button class="btn btn-outline-danger"><span class="job_id">75 : Job ID ba58a29b81c147dfae65cb56dca53167</span></button></div></a><div aria-labelledby="job_list___sub_heading_75_1" data-parent="#job_list___sub_accordion_75" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_75_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 72), end pos: (45, 74)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_Is, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" and request.method is "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:17:28 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:28 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

app/authentication/authenticator.py:45: 13 warnings
  /Users/liamtoozer/eq/eq-questionnaire-runner/app/authentication/authenticator.py:45: SyntaxWarning: "is" with a literal. Did you mean "=="?
    request.endpoint == "session.session_expiry" and request.method is "GET"

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 338 warnings in 4.35s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_76"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_76_1" aria-expanded="false" aria-controls="job_list___sub_collapse_76_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_76_1"><button class="btn btn-outline-success"><span class="job_id">76 : Job ID 17fe31ece67649998367cfc0920ba1ca</span></button></div></a><div aria-labelledby="job_list___sub_heading_76_1" data-parent="#job_list___sub_accordion_76" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_76_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 25), end pos: (45, 27)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_IsNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint is not "session.session_expiry" and request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:17:34 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:34 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10a8bc310&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10a8bc650&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 17, 43, 489231, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1088dd9d0&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:45: in request_load_user
    request.endpoint is not "session.session_expiry" and request.method == "GET"
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Mock spec='Request' id='4471906832'&gt;, name = 'method'

    def __getattr__(self, name):
        if name in {'_mock_methods', '_mock_unsafe'}:
            raise AttributeError(name)
        elif self._mock_methods is not None:
            if name not in self._mock_methods or name in _all_magics:
&gt;               raise AttributeError("Mock object has no attribute %r" % name)
E               AttributeError: Mock object has no attribute 'method'

../../.pyenv/versions/3.11.4/lib/python3.11/unittest/mock.py:653: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:17:38 [info     ] starting eq survey runner      version=local

2023-11-16 08:17:38 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:17:38 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:17:38 [debug    ] load user
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

app/authentication/authenticator.py:45: 13 warnings
  /Users/liamtoozer/eq/eq-questionnaire-runner/app/authentication/authenticator.py:45: SyntaxWarning: "is not" with a literal. Did you mean "!="?
    request.endpoint is not "session.session_expiry" and request.method == "GET"

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 1 failed, 37 passed, 338 warnings in 4.51s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_77"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_77_1" aria-expanded="false" aria-controls="job_list___sub_collapse_77_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_77_1"><button class="btn btn-outline-danger"><span class="job_id">77 : Job ID d4abcaa73e0644cead4edcc8cb4c04d9</span></button></div></a><div aria-labelledby="job_list___sub_heading_77_1" data-parent="#job_list___sub_accordion_77" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_77_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 72), end pos: (45, 74)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Eq_IsNot, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" and request.method is not "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:17:40 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:40 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

app/authentication/authenticator.py:45: 13 warnings
  /Users/liamtoozer/eq/eq-questionnaire-runner/app/authentication/authenticator.py:45: SyntaxWarning: "is not" with a literal. Did you mean "!="?
    request.endpoint == "session.session_expiry" and request.method is not "GET"

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 338 warnings in 4.23s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_78"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_78_1" aria-expanded="false" aria-controls="job_list___sub_collapse_78_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_78_1"><button class="btn btn-outline-success"><span class="job_id">78 : Job ID d27f5fabe9424f0b82540d3b45d710b4</span></button></div></a><div aria-labelledby="job_list___sub_heading_78_1" data-parent="#job_list___sub_accordion_78" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_78_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=77" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (77, 12), end pos: (77, 13)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Gt_Eq, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,8 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
-            &gt; 60
+            or (new_expiration_time - session_store.expiration_time).total_seconds() == 60
         ):
             session_store.expiration_time = new_expiration_time
             session_store.save()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:17:46 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:46 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f35ac10&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10f358d90&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 17, 55, 438808, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f3b2590&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 17, 55, 438808, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 17, 55, 438808, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 17, 55, 438808, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x10f35ac10&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:17:50 [info     ] starting eq survey runner      version=local

2023-11-16 08:17:50 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:17:50 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:17:50 [debug    ] loading user                   user_id=None
2023-11-16 08:17:50 [debug    ] session exists
2023-11-16 08:17:50 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
================== 1 failed, 37 passed, 325 warnings in 4.47s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_79"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_79_1" aria-expanded="false" aria-controls="job_list___sub_collapse_79_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_79_1"><button class="btn btn-outline-success"><span class="job_id">79 : Job ID 99903e6ff6484896849c67490e34f469</span></button></div></a><div aria-labelledby="job_list___sub_heading_79_1" data-parent="#job_list___sub_accordion_79" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_79_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=77" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (77, 12), end pos: (77, 13)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Gt_NotEq, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,8 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
-            &gt; 60
+            or (new_expiration_time - session_store.expiration_time).total_seconds() != 60
         ):
             session_store.expiration_time = new_expiration_time
             session_store.save()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:17:52 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:52 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1079d6e90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1079d7350&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 1, 183163, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x107a093d0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time == expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 18, 1, 184886, tzinfo=datetime.timezone.utc) == datetime.datetime(2023, 11, 16, 8, 18, 1, 183163, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 18, 1, 184886, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x1079d6e90&gt;.expiration_time

tests/app/authentication/test_authenticator.py:149: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:17:56 [info     ] starting eq survey runner      version=local

2023-11-16 08:17:56 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:17:56 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:17:56 [debug    ] loading user                   user_id=None
2023-11-16 08:17:56 [debug    ] session exists
2023-11-16 08:17:56 [debug    ] getting questionnaire data     user_id=user_id
2023-11-16 08:17:56 [debug    ] session expiry extended
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 1 failed, 37 passed, 325 warnings in 4.07s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_80"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_80_1" aria-expanded="false" aria-controls="job_list___sub_collapse_80_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_80_1"><button class="btn btn-outline-success"><span class="job_id">80 : Job ID 0c26e81059b74820a79109c18aa7957f</span></button></div></a><div aria-labelledby="job_list___sub_heading_80_1" data-parent="#job_list___sub_accordion_80" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_80_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=77" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (77, 12), end pos: (77, 13)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Gt_Lt, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,8 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
-            &gt; 60
+            or (new_expiration_time - session_store.expiration_time).total_seconds() &lt; 60
         ):
             session_store.expiration_time = new_expiration_time
             session_store.save()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:17:57 [debug    ] reading from file              filename=.application-version
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:17:58 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x109a1cc90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1099a1410&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 6, 508855, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1099e1e50&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 18, 6, 508855, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 18, 6, 508855, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 18, 6, 508855, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x109a1cc90&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:01 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:01 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:01 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:01 [debug    ] loading user                   user_id=None
2023-11-16 08:18:01 [debug    ] session exists
2023-11-16 08:18:01 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1072a2810&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1072a2ed0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 6, 538978, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1072ddc90&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time == expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 18, 6, 540766, tzinfo=datetime.timezone.utc) == datetime.datetime(2023, 11, 16, 8, 18, 6, 538978, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 18, 6, 540766, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x1072a2810&gt;.expiration_time

tests/app/authentication/test_authenticator.py:149: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:01 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:01 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:01 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:01 [debug    ] loading user                   user_id=None
2023-11-16 08:18:01 [debug    ] session exists
2023-11-16 08:18:01 [debug    ] getting questionnaire data     user_id=user_id
2023-11-16 08:18:01 [debug    ] session expiry extended
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.84s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_81"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_81_1" aria-expanded="false" aria-controls="job_list___sub_collapse_81_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_81_1"><button class="btn btn-outline-success"><span class="job_id">81 : Job ID 5a5010a592274c5f98680cf943a35565</span></button></div></a><div aria-labelledby="job_list___sub_heading_81_1" data-parent="#job_list___sub_accordion_81" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_81_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=77" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (77, 12), end pos: (77, 13)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Gt_LtE, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,8 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
-            &gt; 60
+            or (new_expiration_time - session_store.expiration_time).total_seconds() &lt;= 60
         ):
             session_store.expiration_time = new_expiration_time
             session_store.save()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:18:03 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:03 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10666c750&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10666d510&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 11, 679739, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x106857090&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 18, 11, 679739, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 18, 11, 679739, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 18, 11, 679739, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x10666c750&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:06 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:06 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:06 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:06 [debug    ] loading user                   user_id=None
2023-11-16 08:18:06 [debug    ] session exists
2023-11-16 08:18:06 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1067b5f10&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1067b7610&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 11, 713166, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1067e9950&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time == expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 18, 11, 714774, tzinfo=datetime.timezone.utc) == datetime.datetime(2023, 11, 16, 8, 18, 11, 713166, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 18, 11, 714774, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x1067b5f10&gt;.expiration_time

tests/app/authentication/test_authenticator.py:149: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:06 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:06 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:06 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:06 [debug    ] loading user                   user_id=None
2023-11-16 08:18:06 [debug    ] session exists
2023-11-16 08:18:06 [debug    ] getting questionnaire data     user_id=user_id
2023-11-16 08:18:06 [debug    ] session expiry extended
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.80s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_82"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_82_1" aria-expanded="false" aria-controls="job_list___sub_collapse_82_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_82_1"><button class="btn btn-outline-danger"><span class="job_id">82 : Job ID 24b88e0aa9464a93a8db797ddc4f445f</span></button></div></a><div aria-labelledby="job_list___sub_heading_82_1" data-parent="#job_list___sub_accordion_82" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_82_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=77" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (77, 12), end pos: (77, 13)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Gt_GtE, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,8 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
-            &gt; 60
+            or (new_expiration_time - session_store.expiration_time).total_seconds() &gt;= 60
         ):
             session_store.expiration_time = new_expiration_time
             session_store.save()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:18:08 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:08 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.99s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_83"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_83_1" aria-expanded="false" aria-controls="job_list___sub_collapse_83_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_83_1"><button class="btn btn-outline-success"><span class="job_id">83 : Job ID ab6a9467b9da424da679e0257804556a</span></button></div></a><div aria-labelledby="job_list___sub_heading_83_1" data-parent="#job_list___sub_accordion_83" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_83_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 41), end pos: (93, 43)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_GtE_Eq, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        or session_store.expiration_time == datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...............................FFF.F.F                                   [100%]2023-11-16 08:18:13 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:14 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x111dc2f50&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x111dc30d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 22, 510459, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x111d46210&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = load_user()
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:30: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:17 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:17 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:17 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:17 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 22, 510459, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:17 [info     ] session does not exist
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f53eb50&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10f473390&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 22, 508383, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f663810&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:71: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:17 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:17 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:17 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:17 [debug    ] loading user                   user_id=None
2023-11-16 08:18:17 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 22, 508383, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:17 [info     ] session does not exist
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1127dbe90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x11279c590&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 22, 508684, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1127db650&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:172: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:17 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:17 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:17 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:17 [debug    ] loading user                   user_id=None
2023-11-16 08:18:17 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 22, 508684, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:17 [info     ] session does not exist
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10bb9f090&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10bb9f550&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 22, 538271, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10bbfd350&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:146: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:17 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:17 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:17 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:17 [debug    ] loading user                   user_id=None
2023-11-16 08:18:17 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 22, 538271, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:17 [info     ] session does not exist
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f714510&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10f7147d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 22, 716111, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f661490&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = request_load_user(mocker.Mock(Request))
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:95: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:17 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:17 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:17 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:17 [debug    ] load user
2023-11-16 08:18:17 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 22, 716111, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:17 [info     ] session does not exist
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_authenticator.py::test_load_user - Attri...
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 5 failed, 33 passed, 325 warnings in 4.02s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_84"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_84_1" aria-expanded="false" aria-controls="job_list___sub_collapse_84_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_84_1"><button class="btn btn-outline-success"><span class="job_id">84 : Job ID 357ac98023a64a9e9a21996846522d2f</span></button></div></a><div aria-labelledby="job_list___sub_heading_84_1" data-parent="#job_list___sub_accordion_84" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_84_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 41), end pos: (93, 43)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_GtE_NotEq, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        or session_store.expiration_time != datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:18:19 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:19 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________ test_no_user_when_session_has_expired _____________________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x11084a510&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x110896c50&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x110886610&gt;

    def test_no_user_when_session_has_expired(
        app,
        session_store,
        session_data,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at=datetime.now(timezone.utc),
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user is None
E           assert &lt;app.authentication.user.User object at 0x110887310&gt; is None

tests/app/authentication/test_authenticator.py:122: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:22 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:22 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:22 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:22 [debug    ] loading user                   user_id=None
2023-11-16 08:18:22 [debug    ] session exists
2023-11-16 08:18:22 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
================== 1 failed, 37 passed, 325 warnings in 3.91s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_85"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_85_1" aria-expanded="false" aria-controls="job_list___sub_collapse_85_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_85_1"><button class="btn btn-outline-success"><span class="job_id">85 : Job ID 1e33a05a29ab45b6b8b56fd155a12639</span></button></div></a><div aria-labelledby="job_list___sub_heading_85_1" data-parent="#job_list___sub_accordion_85" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_85_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 41), end pos: (93, 43)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_GtE_Lt, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        or session_store.expiration_time &lt; datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

..............................FFFF..FF                                   [100%]2023-11-16 08:18:24 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:25 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________ test_no_user_when_session_has_expired _____________________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x106fe12d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x106e6db90&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x106fb65d0&gt;

    def test_no_user_when_session_has_expired(
        app,
        session_store,
        session_data,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at=datetime.now(timezone.utc),
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user is None
E           assert &lt;app.authentication.user.User object at 0x106e7ca10&gt; is None

tests/app/authentication/test_authenticator.py:122: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:28 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:28 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:28 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:28 [debug    ] loading user                   user_id=None
2023-11-16 08:18:28 [debug    ] session exists
2023-11-16 08:18:28 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x114480290&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1144806d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 33, 229441, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x114404110&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:172: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:28 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:28 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:28 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:28 [debug    ] loading user                   user_id=None
2023-11-16 08:18:28 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 33, 229441, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:28 [info     ] session does not exist
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10a882710&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10a882d50&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 33, 227806, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10a845a10&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = load_user()
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:30: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:28 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:28 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:28 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:28 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 33, 227806, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:28 [info     ] session does not exist
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x113d16bd0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x113d14110&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 33, 228545, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x113cafc10&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:71: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:28 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:28 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:28 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:28 [debug    ] loading user                   user_id=None
2023-11-16 08:18:28 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 33, 228545, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:28 [info     ] session does not exist
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x107078ed0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10707a090&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 33, 435926, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x105070ad0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:146: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:28 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:28 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:28 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:28 [debug    ] loading user                   user_id=None
2023-11-16 08:18:28 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 33, 435926, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:28 [info     ] session does not exist
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x113d989d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x113d988d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 33, 436195, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x113cad650&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = request_load_user(mocker.Mock(Request))
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:95: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:28 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:28 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:28 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:28 [debug    ] load user
2023-11-16 08:18:28 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 33, 436195, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:28 [info     ] session does not exist
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_authenticator.py::test_load_user - Attri...
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 6 failed, 32 passed, 325 warnings in 3.94s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_86"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_86_1" aria-expanded="false" aria-controls="job_list___sub_collapse_86_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_86_1"><button class="btn btn-outline-success"><span class="job_id">86 : Job ID f96220c9ffb14b0ab6decb845fec63e2</span></button></div></a><div aria-labelledby="job_list___sub_heading_86_1" data-parent="#job_list___sub_accordion_86" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_86_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 41), end pos: (93, 43)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_GtE_LtE, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        or session_store.expiration_time &lt;= datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

..............................FFFF..FF                                   [100%]2023-11-16 08:18:29 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:30 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x110f15050&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x110f16d10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 38, 633902, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1111019d0&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:71: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:33 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:33 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:33 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:33 [debug    ] loading user                   user_id=None
2023-11-16 08:18:33 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 38, 633902, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:33 [info     ] session does not exist
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x105e4f390&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1057768d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 38, 631784, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x105dc2ed0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:172: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:33 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:33 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:33 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:33 [debug    ] loading user                   user_id=None
2023-11-16 08:18:33 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 38, 631784, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:33 [info     ] session does not exist
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10fd31bd0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10fd33110&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 38, 631552, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10fd08f10&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = load_user()
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:30: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:33 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:33 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:33 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:33 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 38, 631552, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:33 [info     ] session does not exist
____________________ test_no_user_when_session_has_expired _____________________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f5b3a50&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10f5b33d0&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f5bf450&gt;

    def test_no_user_when_session_has_expired(
        app,
        session_store,
        session_data,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at=datetime.now(timezone.utc),
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user is None
E           assert &lt;app.authentication.user.User object at 0x10d69e050&gt; is None

tests/app/authentication/test_authenticator.py:122: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:33 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:33 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:33 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:33 [debug    ] loading user                   user_id=None
2023-11-16 08:18:33 [debug    ] session exists
2023-11-16 08:18:33 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f651390&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10f651e10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 38, 835616, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f65cc10&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:146: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:33 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:33 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:33 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:33 [debug    ] loading user                   user_id=None
2023-11-16 08:18:33 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 38, 835616, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:33 [info     ] session does not exist
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1111aaf10&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1111aa390&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 38, 835633, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1111014d0&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = request_load_user(mocker.Mock(Request))
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:95: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:33 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:33 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:33 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:33 [debug    ] load user
2023-11-16 08:18:33 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 38, 835633, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:33 [info     ] session does not exist
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_load_user - Attri...
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 6 failed, 32 passed, 325 warnings in 3.93s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_87"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_87_1" aria-expanded="false" aria-controls="job_list___sub_collapse_87_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_87_1"><button class="btn btn-outline-danger"><span class="job_id">87 : Job ID b9dfea24c7444c9b84019536465696e6</span></button></div></a><div aria-labelledby="job_list___sub_heading_87_1" data-parent="#job_list___sub_accordion_87" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_87_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 41), end pos: (93, 43)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_GtE_Gt, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        or session_store.expiration_time &gt; datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:18:35 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:35 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.75s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_88"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_88_1" aria-expanded="false" aria-controls="job_list___sub_collapse_88_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_88_1"><button class="btn btn-outline-success"><span class="job_id">88 : Job ID 3067a24ad47640b0b1e009ed47a0b50c</span></button></div></a><div aria-labelledby="job_list___sub_heading_88_1" data-parent="#job_list___sub_accordion_88" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_88_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 41), end pos: (93, 43)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_GtE_Is, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        or session_store.expiration_time is datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...............................FFF.F.F                                   [100%]2023-11-16 08:18:40 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:41 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10d783b50&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10d847550&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 49, 119498, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10d9cb310&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:172: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:44 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:44 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:44 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:44 [debug    ] loading user                   user_id=None
2023-11-16 08:18:44 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 49, 119498, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:44 [info     ] session does not exist
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x106c12610&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x106c10e50&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 49, 117648, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x106c2e910&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = load_user()
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:30: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:44 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:44 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:44 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:44 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 49, 117648, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:44 [info     ] session does not exist
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1120b8090&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1120b8f10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 49, 118246, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112187c50&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:71: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:44 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:44 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:44 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:44 [debug    ] loading user                   user_id=None
2023-11-16 08:18:44 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 49, 118246, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:44 [info     ] session does not exist
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10c8afc10&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10c915c10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 49, 149595, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10c8f9390&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:146: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:44 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:44 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:44 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:44 [debug    ] loading user                   user_id=None
2023-11-16 08:18:44 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 49, 149595, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:44 [info     ] session does not exist
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x112166150&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1121657d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 18, 49, 324365, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x112186d10&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = request_load_user(mocker.Mock(Request))
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:95: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:44 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:44 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:44 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:44 [debug    ] load user
2023-11-16 08:18:44 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 18, 49, 324365, tzinfo=datetime.timezone.utc)
2023-11-16 08:18:44 [info     ] session does not exist
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_authenticator.py::test_load_user - Attri...
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 5 failed, 33 passed, 325 warnings in 3.95s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_89"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_89_1" aria-expanded="false" aria-controls="job_list___sub_collapse_89_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_89_1"><button class="btn btn-outline-success"><span class="job_id">89 : Job ID 06be96ffad3f45759bdd5d7dabf029e8</span></button></div></a><div aria-labelledby="job_list___sub_heading_89_1" data-parent="#job_list___sub_accordion_89" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_89_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 41), end pos: (93, 43)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_GtE_IsNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        or session_store.expiration_time is not datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:18:45 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:46 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________ test_no_user_when_session_has_expired _____________________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x108500910&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x108502f10&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1084c5b90&gt;

    def test_no_user_when_session_has_expired(
        app,
        session_store,
        session_data,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at=datetime.now(timezone.utc),
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user is None
E           assert &lt;app.authentication.user.User object at 0x108298290&gt; is None

tests/app/authentication/test_authenticator.py:122: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:49 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:49 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:49 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:49 [debug    ] loading user                   user_id=None
2023-11-16 08:18:49 [debug    ] session exists
2023-11-16 08:18:49 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
================== 1 failed, 37 passed, 325 warnings in 3.92s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_90"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_90_1" aria-expanded="false" aria-controls="job_list___sub_collapse_90_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_90_1"><button class="btn btn-outline-danger"><span class="job_id">90 : Job ID a52788d3539e4a47a4d7f190b64885e2</span></button></div></a><div aria-labelledby="job_list___sub_heading_90_1" data-parent="#job_list___sub_accordion_90" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_90_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=44" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (44, 21), end pos: (44, 24)</button></a></pre><pre>operator: core/ReplaceUnaryOperator_Delete_Not, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -41,7 +41,7 @@
 ) -&gt; Optional[User]:
     logger.debug("load user")
 
-    extend_session = not (
+    extend_session =  (
         request.endpoint == "session.session_expiry" and request.method == "GET"
     )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:18:51 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:51 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.73s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_91"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_91_1" aria-expanded="false" aria-controls="job_list___sub_collapse_91_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_91_1"><button class="btn btn-outline-success"><span class="job_id">91 : Job ID 351399d1994e4fcb9de1a77fac7d0868</span></button></div></a><div aria-labelledby="job_list___sub_heading_91_1" data-parent="#job_list___sub_accordion_91" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_91_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=75" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (75, 12), end pos: (75, 15)</button></a></pre><pre>operator: core/ReplaceUnaryOperator_Delete_Not, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -72,7 +72,7 @@
 
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
-            not session_store.expiration_time
+             session_store.expiration_time
             or (new_expiration_time - session_store.expiration_time).total_seconds()
             &gt; 60
         ):</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:18:56 [debug    ] reading from file              filename=.application-version
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:18:56 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10994b490&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10994b990&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 4, 943593, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10997d6d0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time == expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 19, 4, 945175, tzinfo=datetime.timezone.utc) == datetime.datetime(2023, 11, 16, 8, 19, 4, 943593, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 19, 4, 945175, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x10994b490&gt;.expiration_time

tests/app/authentication/test_authenticator.py:149: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:18:59 [info     ] starting eq survey runner      version=local

2023-11-16 08:18:59 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:18:59 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:18:59 [debug    ] loading user                   user_id=None
2023-11-16 08:18:59 [debug    ] session exists
2023-11-16 08:18:59 [debug    ] getting questionnaire data     user_id=user_id
2023-11-16 08:18:59 [debug    ] session expiry extended
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 1 failed, 37 passed, 325 warnings in 3.85s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_92"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_92_1" aria-expanded="false" aria-controls="job_list___sub_collapse_92_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_92_1"><button class="btn btn-outline-success"><span class="job_id">92 : Job ID 09d0d006689e438f92b14625f322af20</span></button></div></a><div aria-labelledby="job_list___sub_heading_92_1" data-parent="#job_list___sub_accordion_92" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_92_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=92" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (92, 8), end pos: (92, 11)</button></a></pre><pre>operator: core/ReplaceUnaryOperator_Delete_Not, occurrence: 2</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -89,7 +89,7 @@
     """
 
     return (
-        not session_store.expiration_time
+         session_store.expiration_time
         or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
     )
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:19:01 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:02 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________ test_no_user_when_session_has_expired _____________________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x109e12b50&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x109e12e90&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x109dd5090&gt;

    def test_no_user_when_session_has_expired(
        app,
        session_store,
        session_data,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at=datetime.now(timezone.utc),
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user is None
E           assert &lt;app.authentication.user.User object at 0x107f3a7d0&gt; is None

tests/app/authentication/test_authenticator.py:122: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:05 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:05 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:05 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:05 [debug    ] loading user                   user_id=None
2023-11-16 08:19:05 [debug    ] session exists
2023-11-16 08:19:05 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
================== 1 failed, 37 passed, 325 warnings in 4.08s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_93"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_93_1" aria-expanded="false" aria-controls="job_list___sub_collapse_93_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_93_1"><button class="btn btn-outline-success"><span class="job_id">93 : Job ID 9ba8de02deef4a6ca44536c7f939e02d</span></button></div></a><div aria-labelledby="job_list___sub_heading_93_1" data-parent="#job_list___sub_accordion_93" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_93_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=121" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (121, 7), end pos: (121, 10)</button></a></pre><pre>operator: core/ReplaceUnaryOperator_Delete_Not, occurrence: 3</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -118,7 +118,7 @@
 
         return user
 
-    if not session_store:
+    if  session_store:
         logger.info("session store doesn't exist")  # pragma: no cover
 
     elif not _is_session_valid(session_store):</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:19:07 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:07 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
________________ test_check_session_with_no_user_id_in_session _________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10bfd6850&gt;

    def test_check_session_with_no_user_id_in_session(app, mocker):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=None
        )
    
        with app.app_context():
            # Given / When
&gt;           user = load_user()

tests/app/authentication/test_authenticator.py:41: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:124: in load_user
    elif not _is_session_valid(session_store):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = None

    def _is_session_valid(session_store: SessionStore) -&gt; bool:
        """
        Checks that the user's session has not expired
        :param session_store:
        :return: True if the session is valid else False
        """
    
        return (
&gt;           not session_store.expiration_time
            or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
        )
E       AttributeError: 'NoneType' object has no attribute 'expiration_time'

app/authentication/authenticator.py:92: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:10 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
================== 1 failed, 37 passed, 325 warnings in 3.96s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_94"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_94_1" aria-expanded="false" aria-controls="job_list___sub_collapse_94_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_94_1"><button class="btn btn-outline-danger"><span class="job_id">94 : Job ID 017d0ed5849c497fac2c33ce249fc106</span></button></div></a><div aria-labelledby="job_list___sub_heading_94_1" data-parent="#job_list___sub_accordion_94" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_94_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=124" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (124, 9), end pos: (124, 12)</button></a></pre><pre>operator: core/ReplaceUnaryOperator_Delete_Not, occurrence: 4</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -121,7 +121,7 @@
     if not session_store:
         logger.info("session store doesn't exist")  # pragma: no cover
 
-    elif not _is_session_valid(session_store):
+    elif  _is_session_valid(session_store):
         logger.info(
             "session has expired", session_expiry=session_store.expiration_time
         )  # pragma: no cover</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:19:12 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:13 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.76s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_95"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_95_1" aria-expanded="false" aria-controls="job_list___sub_collapse_95_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_95_1"><button class="btn btn-outline-danger"><span class="job_id">95 : Job ID 66841b0bd2e743a186fae5dfa37a57a2</span></button></div></a><div aria-labelledby="job_list___sub_heading_95_1" data-parent="#job_list___sub_accordion_95" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_95_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=179" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (179, 7), end pos: (179, 10)</button></a></pre><pre>operator: core/ReplaceUnaryOperator_Delete_Not, occurrence: 5</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -176,7 +176,7 @@
 
 
 def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
-    if not encrypted_token:
+    if  encrypted_token:
         raise NoTokenException("Please provide a token")
 
     logger.debug("decrypting token")</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:19:17 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:18 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.92s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_96"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_96_1" aria-expanded="false" aria-controls="job_list___sub_collapse_96_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_96_1"><button class="btn btn-outline-danger"><span class="job_id">96 : Job ID 9715f70d82b24721bd6b48bd3cf0422b</span></button></div></a><div aria-labelledby="job_list___sub_heading_96_1" data-parent="#job_list___sub_accordion_96" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_96_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=57" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (57, 7), end pos: (57, 20)</button></a></pre><pre>operator: core/AddNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -54,7 +54,7 @@
 ) -&gt; None:
     logger.debug("log out user")
     session_store = get_session_store()
-    if session_store:
+    if not session_store:
         session_store.delete()
     cookie_session.pop(USER_IK, None)
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:19:23 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:23 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 4.27s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_97"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_97_1" aria-expanded="false" aria-controls="job_list___sub_collapse_97_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_97_1"><button class="btn btn-outline-success"><span class="job_id">97 : Job ID 0098c274d6bc4431879b6f5d9bf48a69</span></button></div></a><div aria-labelledby="job_list___sub_heading_97_1" data-parent="#job_list___sub_accordion_97" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_97_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=68" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (68, 7), end pos: (68, 22)</button></a></pre><pre>operator: core/AddNot, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -65,7 +65,7 @@
     :param session_store:
     """
     session_timeout = cookie_session.get("expires_in")
-    if session_timeout:
+    if not session_timeout:
         new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
             seconds=session_timeout
         )</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

................................F.FF.F                                   [100%]2023-11-16 08:19:28 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:29 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1123169d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1142b56d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 37, 577614, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1142d2110&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 19, 37, 577614, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 19, 37, 577614, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 19, 37, 577614, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x1123169d0&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:32 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:32 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:32 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:32 [debug    ] loading user                   user_id=None
2023-11-16 08:19:32 [debug    ] session exists
2023-11-16 08:19:32 [debug    ] getting questionnaire data     user_id=user_id
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x107d28850&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x107d29990&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 37, 577602, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x107daa650&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = load_user()

tests/app/authentication/test_authenticator.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x107d28850&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if not session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported type for timedelta seconds component: NoneType

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:32 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:32 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:32 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:32 [debug    ] session exists
2023-11-16 08:19:32 [debug    ] getting questionnaire data     user_id=user_id
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x111610e90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x111613f50&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 37, 580752, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1115c5190&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = user_loader(None)

tests/app/authentication/test_authenticator.py:68: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:35: in user_loader
    return load_user()
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x111610e90&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if not session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported type for timedelta seconds component: NoneType

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:32 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:32 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:32 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:32 [debug    ] loading user                   user_id=None
2023-11-16 08:19:32 [debug    ] session exists
2023-11-16 08:19:32 [debug    ] getting questionnaire data     user_id=user_id
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1116ac990&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1116ad010&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 37, 789008, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1116f8f10&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:48: in request_load_user
    return load_user(extend_session=extend_session)
app/authentication/authenticator.py:117: in load_user
    _extend_session_expiry(session_store)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = &lt;app.data_models.session_store.SessionStore object at 0x1116ac990&gt;

    def _extend_session_expiry(session_store: SessionStore) -&gt; None:
        """
        Extends the expiration time of the session
        :param session_store:
        """
        session_timeout = cookie_session.get("expires_in")
        if not session_timeout:
&gt;           new_expiration_time = datetime.now(tz=timezone.utc) + timedelta(
                seconds=session_timeout
            )
E           TypeError: unsupported type for timedelta seconds component: NoneType

app/authentication/authenticator.py:69: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:32 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:32 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:32 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:32 [debug    ] load user
2023-11-16 08:19:32 [debug    ] session exists
2023-11-16 08:19:32 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_authenticator.py::test_load_user - TypeE...
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 4 failed, 34 passed, 325 warnings in 3.88s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_98"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_98_1" aria-expanded="false" aria-controls="job_list___sub_collapse_98_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_98_1"><button class="btn btn-outline-success"><span class="job_id">98 : Job ID 66817c99e2624f75a79b96ed749ffdf5</span></button></div></a><div aria-labelledby="job_list___sub_heading_98_1" data-parent="#job_list___sub_accordion_98" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_98_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=74" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (74, 11), end pos: (78, 9)</button></a></pre><pre>operator: core/AddNot, occurrence: 2</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -71,7 +71,7 @@
         )
 
         # Only update expiry time if its greater than 60s different to what is currently set
-        if (
+        if not (
             not session_store.expiration_time
             or (new_expiration_time - session_store.expiration_time).total_seconds()
             &gt; 60</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................F.F                                   [100%]2023-11-16 08:19:34 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:34 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x105b16a10&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x105b14510&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 42, 869230, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x105b2ed90&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 19, 42, 869230, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 19, 42, 869230, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 19, 42, 869230, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x105b16a10&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:37 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:37 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:37 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:37 [debug    ] loading user                   user_id=None
2023-11-16 08:19:37 [debug    ] session exists
2023-11-16 08:19:37 [debug    ] getting questionnaire data     user_id=user_id
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x114853550&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x114853890&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 42, 900752, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x11488d710&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time == expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 19, 42, 902394, tzinfo=datetime.timezone.utc) == datetime.datetime(2023, 11, 16, 8, 19, 42, 900752, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 19, 42, 902394, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x114853550&gt;.expiration_time

tests/app/authentication/test_authenticator.py:149: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:37 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:37 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:37 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:37 [debug    ] loading user                   user_id=None
2023-11-16 08:19:37 [debug    ] session exists
2023-11-16 08:19:37 [debug    ] getting questionnaire data     user_id=user_id
2023-11-16 08:19:37 [debug    ] session expiry extended
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
================== 2 failed, 36 passed, 325 warnings in 3.94s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_99"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_99_1" aria-expanded="false" aria-controls="job_list___sub_collapse_99_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_99_1"><button class="btn btn-outline-success"><span class="job_id">99 : Job ID e89e3b7dd964443baf0b51489c0f79a6</span></button></div></a><div aria-labelledby="job_list___sub_heading_99_1" data-parent="#job_list___sub_accordion_99" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_99_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=106" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (106, 7), end pos: (106, 57)</button></a></pre><pre>operator: core/AddNot, occurrence: 3</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -103,7 +103,7 @@
     """
     session_store = get_session_store()
 
-    if session_store and _is_session_valid(session_store):
+    if not session_store and _is_session_valid(session_store):
         logger.debug("session exists")
 
         user_id = session_store.user_id</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...............................FFF.FFF                                   [100%]2023-11-16 08:19:39 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:40 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10f902ed0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10f900150&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 48, 338056, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f8f08d0&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = load_user()
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:30: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:43 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:43 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:43 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:43 [info     ] session does not exist
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x105839410&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x105849a10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 48, 340474, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x105814690&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:71: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:43 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:43 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:43 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:43 [debug    ] loading user                   user_id=None
2023-11-16 08:19:43 [info     ] session does not exist
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10a06a0d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10a069d50&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 48, 344637, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10a045710&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:172: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:43 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:43 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:43 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:43 [debug    ] loading user                   user_id=None
2023-11-16 08:19:43 [info     ] session does not exist
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10e617050&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10e617510&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 48, 371333, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10e625a10&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:146: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:43 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:43 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:43 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:43 [debug    ] loading user                   user_id=None
2023-11-16 08:19:43 [info     ] session does not exist
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1058ac810&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1058ac4d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 48, 542122, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x1055d39d0&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = request_load_user(mocker.Mock(Request))
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:95: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:43 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:43 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:43 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:43 [debug    ] load user
2023-11-16 08:19:43 [info     ] session does not exist
________________ test_check_session_with_no_user_id_in_session _________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10f900b90&gt;

    def test_check_session_with_no_user_id_in_session(app, mocker):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=None
        )
    
        with app.app_context():
            # Given / When
&gt;           user = load_user()

tests/app/authentication/test_authenticator.py:41: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:106: in load_user
    if not session_store and _is_session_valid(session_store):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = None

    def _is_session_valid(session_store: SessionStore) -&gt; bool:
        """
        Checks that the user's session has not expired
        :param session_store:
        :return: True if the session is valid else False
        """
    
        return (
&gt;           not session_store.expiration_time
            or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
        )
E       AttributeError: 'NoneType' object has no attribute 'expiration_time'

app/authentication/authenticator.py:92: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:43 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_authenticator.py::test_load_user - Attri...
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
================== 6 failed, 32 passed, 325 warnings in 3.94s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_100"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_100_1" aria-expanded="false" aria-controls="job_list___sub_collapse_100_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_100_1"><button class="btn btn-outline-success"><span class="job_id">100 : Job ID 89cd71f7ec2d47d1b05798fced935b77</span></button></div></a><div aria-labelledby="job_list___sub_heading_100_1" data-parent="#job_list___sub_accordion_100" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_100_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=113" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (113, 11), end pos: (113, 41)</button></a></pre><pre>operator: core/AddNot, occurrence: 4</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -110,7 +110,7 @@
         user_ik = cookie_session.get(USER_IK)
         user = User(user_id, user_ik)
 
-        if metadata := get_metadata(user):
+        if not metadata := get_metadata(user):
             contextvars.bind_contextvars(tx_id=metadata.tx_id)
 
         if extend_session:</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:23: in &lt;module&gt;
    from app.authentication.authenticator import login_manager
E     File "/Users/liamtoozer/eq/eq-questionnaire-runner/app/authentication/authenticator.py", line 113
E       if not metadata := get_metadata(user):
E          ^^^^^^^^^^^^
E   SyntaxError: cannot use assignment expressions with expression
2023-11-16 08:19:45 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_101"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_101_1" aria-expanded="false" aria-controls="job_list___sub_collapse_101_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_101_1"><button class="btn btn-outline-success"><span class="job_id">101 : Job ID a17d8925dcbd4f0599692861f09c9f2d</span></button></div></a><div aria-labelledby="job_list___sub_heading_101_1" data-parent="#job_list___sub_accordion_101" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_101_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=116" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (116, 11), end pos: (116, 25)</button></a></pre><pre>operator: core/AddNot, occurrence: 5</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -113,7 +113,7 @@
         if metadata := get_metadata(user):
             contextvars.bind_contextvars(tx_id=metadata.tx_id)
 
-        if extend_session:
+        if not extend_session:
             _extend_session_expiry(session_store)
 
         return user</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:19:46 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:46 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10b4ab8d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10b4ab1d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 19, 54, 987062, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10b5b2550&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 19, 54, 987062, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 19, 54, 987062, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 19, 54, 987062, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x10b4ab8d0&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:49 [info     ] starting eq survey runner      version=local

2023-11-16 08:19:49 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:19:49 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:19:49 [debug    ] loading user                   user_id=None
2023-11-16 08:19:49 [debug    ] session exists
2023-11-16 08:19:49 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
================== 1 failed, 37 passed, 325 warnings in 3.86s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_102"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_102_1" aria-expanded="false" aria-controls="job_list___sub_collapse_102_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_102_1"><button class="btn btn-outline-success"><span class="job_id">102 : Job ID cce963c054f24e4f88b95d2e0ac3d3c7</span></button></div></a><div aria-labelledby="job_list___sub_heading_102_1" data-parent="#job_list___sub_accordion_102" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_102_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=121" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (121, 7), end pos: (121, 24)</button></a></pre><pre>operator: core/AddNot, occurrence: 6</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -118,7 +118,7 @@
 
         return user
 
-    if not session_store:
+    if not not session_store:
         logger.info("session store doesn't exist")  # pragma: no cover
 
     elif not _is_session_valid(session_store):</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:19:51 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:52 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
________________ test_check_session_with_no_user_id_in_session _________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10ad55f50&gt;

    def test_check_session_with_no_user_id_in_session(app, mocker):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=None
        )
    
        with app.app_context():
            # Given / When
&gt;           user = load_user()

tests/app/authentication/test_authenticator.py:41: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:124: in load_user
    elif not _is_session_valid(session_store):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = None

    def _is_session_valid(session_store: SessionStore) -&gt; bool:
        """
        Checks that the user's session has not expired
        :param session_store:
        :return: True if the session is valid else False
        """
    
        return (
&gt;           not session_store.expiration_time
            or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
        )
E       AttributeError: 'NoneType' object has no attribute 'expiration_time'

app/authentication/authenticator.py:92: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:19:55 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
================== 1 failed, 37 passed, 325 warnings in 3.84s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_103"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_103_1" aria-expanded="false" aria-controls="job_list___sub_collapse_103_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_103_1"><button class="btn btn-outline-danger"><span class="job_id">103 : Job ID fd62566671d64564ac16034e25c88460</span></button></div></a><div aria-labelledby="job_list___sub_heading_103_1" data-parent="#job_list___sub_accordion_103" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_103_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=179" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (179, 7), end pos: (179, 26)</button></a></pre><pre>operator: core/AddNot, occurrence: 7</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -176,7 +176,7 @@
 
 
 def decrypt_token(encrypted_token: str | None) -&gt; dict[str, Any]:
-    if not encrypted_token:
+    if not not encrypted_token:
         raise NoTokenException("Please provide a token")
 
     logger.debug("decrypting token")</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:19:56 [debug    ] reading from file              filename=.application-version
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:19:57 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.88s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_104"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_104_1" aria-expanded="false" aria-controls="job_list___sub_collapse_104_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_104_1"><button class="btn btn-outline-success"><span class="job_id">104 : Job ID 44e655c6b99e4f628ddf75a03ebe141d</span></button></div></a><div aria-labelledby="job_list___sub_heading_104_1" data-parent="#job_list___sub_accordion_104" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_104_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=97" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (97, 37), end pos: (97, 41)</button></a></pre><pre>operator: core/ReplaceTrueWithFalse, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -94,7 +94,7 @@
     )
 
 
-def load_user(extend_session: bool = True) -&gt; Optional[User]:
+def load_user(extend_session: bool = False) -&gt; Optional[User]:
     """
     Checks for the present of the JWT in the users sessions
     :return: A user object if a JWT token is available in the session</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:20:02 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:02 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x110cf71d0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x110d31f90&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 10, 913515, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x110d0fa50&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 20, 10, 913515, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 20, 10, 913515, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 20, 10, 913515, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x110cf71d0&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:05 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:05 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:05 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:05 [debug    ] loading user                   user_id=None
2023-11-16 08:20:05 [debug    ] session exists
2023-11-16 08:20:05 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
================== 1 failed, 37 passed, 325 warnings in 3.87s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_105"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_105_1" aria-expanded="false" aria-controls="job_list___sub_collapse_105_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_105_1"><button class="btn btn-outline-success"><span class="job_id">105 : Job ID 5052f683239d493181d25f1cf0616afc</span></button></div></a><div aria-labelledby="job_list___sub_heading_105_1" data-parent="#job_list___sub_accordion_105" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_105_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=45" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (45, 53), end pos: (45, 56)</button></a></pre><pre>operator: core/ReplaceAndWithOr, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -42,7 +42,7 @@
     logger.debug("load user")
 
     extend_session = not (
-        request.endpoint == "session.session_expiry" and request.method == "GET"
+        request.endpoint == "session.session_expiry" or request.method == "GET"
     )
 
     return load_user(extend_session=extend_session)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.....................................F                                   [100%]2023-11-16 08:20:07 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:08 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x111256710&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x111255a10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 16, 389245, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x111255bd0&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
&gt;           user = request_load_user(mocker.Mock(Request))

tests/app/authentication/test_authenticator.py:92: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:45: in request_load_user
    request.endpoint == "session.session_expiry" or request.method == "GET"
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Mock spec='Request' id='4582633616'&gt;, name = 'method'

    def __getattr__(self, name):
        if name in {'_mock_methods', '_mock_unsafe'}:
            raise AttributeError(name)
        elif self._mock_methods is not None:
            if name not in self._mock_methods or name in _all_magics:
&gt;               raise AttributeError("Mock object has no attribute %r" % name)
E               AttributeError: Mock object has no attribute 'method'

../../.pyenv/versions/3.11.4/lib/python3.11/unittest/mock.py:653: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:11 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:11 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:11 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:11 [debug    ] load user
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 1 failed, 37 passed, 325 warnings in 4.07s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_106"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_106_1" aria-expanded="false" aria-controls="job_list___sub_collapse_106_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_106_1"><button class="btn btn-outline-success"><span class="job_id">106 : Job ID 1845029e443344a4a2a27932df22db4f</span></button></div></a><div aria-labelledby="job_list___sub_heading_106_1" data-parent="#job_list___sub_accordion_106" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_106_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=106" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (106, 21), end pos: (106, 24)</button></a></pre><pre>operator: core/ReplaceAndWithOr, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -103,7 +103,7 @@
     """
     session_store = get_session_store()
 
-    if session_store and _is_session_valid(session_store):
+    if session_store or _is_session_valid(session_store):
         logger.debug("session exists")
 
         user_id = session_store.user_id</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...................................FF.                                   [100%]2023-11-16 08:20:13 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:13 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____________________ test_no_user_when_session_has_expired _____________________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1090c6fd0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1090c5010&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x109039650&gt;

    def test_no_user_when_session_has_expired(
        app,
        session_store,
        session_data,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at=datetime.now(timezone.utc),
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user is None
E           assert &lt;app.authentication.user.User object at 0x109094210&gt; is None

tests/app/authentication/test_authenticator.py:122: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:16 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:16 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:16 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:16 [debug    ] loading user                   user_id=None
2023-11-16 08:20:16 [debug    ] session exists
2023-11-16 08:20:16 [debug    ] getting questionnaire data     user_id=user_id
________________ test_check_session_with_no_user_id_in_session _________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10e1b4c50&gt;

    def test_check_session_with_no_user_id_in_session(app, mocker):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=None
        )
    
        with app.app_context():
            # Given / When
&gt;           user = load_user()

tests/app/authentication/test_authenticator.py:41: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/authenticator.py:106: in load_user
    if session_store or _is_session_valid(session_store):
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

session_store = None

    def _is_session_valid(session_store: SessionStore) -&gt; bool:
        """
        Checks that the user's session has not expired
        :param session_store:
        :return: True if the session is valid else False
        """
    
        return (
&gt;           not session_store.expiration_time
            or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
        )
E       AttributeError: 'NoneType' object has no attribute 'expiration_time'

app/authentication/authenticator.py:92: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:16 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
================== 2 failed, 36 passed, 325 warnings in 3.84s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_107"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_107_1" aria-expanded="false" aria-controls="job_list___sub_collapse_107_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_107_1"><button class="btn btn-outline-success"><span class="job_id">107 : Job ID 9a5c6d6bb2d34659a374ac2b28901648</span></button></div></a><div aria-labelledby="job_list___sub_heading_107_1" data-parent="#job_list___sub_accordion_107" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_107_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=76" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (76, 12), end pos: (76, 14)</button></a></pre><pre>operator: core/ReplaceOrWithAnd, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -73,7 +73,7 @@
         # Only update expiry time if its greater than 60s different to what is currently set
         if (
             not session_store.expiration_time
-            or (new_expiration_time - session_store.expiration_time).total_seconds()
+            and (new_expiration_time - session_store.expiration_time).total_seconds()
             &gt; 60
         ):
             session_store.expiration_time = new_expiration_time</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:20:18 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:18 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x1080c9850&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1080ca710&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 26, 869519, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x10803f8d0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
            assert user.user_id == "user_id"
            assert user.user_ik == "user_ik"
            assert user.is_authenticated is True
&gt;           assert session_store.expiration_time &gt; expires_at
E           assert datetime.datetime(2023, 11, 16, 8, 20, 26, 869519, tzinfo=datetime.timezone.utc) &gt; datetime.datetime(2023, 11, 16, 8, 20, 26, 869519, tzinfo=datetime.timezone.utc)
E            +  where datetime.datetime(2023, 11, 16, 8, 20, 26, 869519, tzinfo=datetime.timezone.utc) = &lt;app.data_models.session_store.SessionStore object at 0x1080c9850&gt;.expiration_time

tests/app/authentication/test_authenticator.py:175: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:21 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:21 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:21 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:21 [debug    ] loading user                   user_id=None
2023-11-16 08:20:21 [debug    ] session exists
2023-11-16 08:20:21 [debug    ] getting questionnaire data     user_id=user_id
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
================== 1 failed, 37 passed, 325 warnings in 3.79s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_108"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_108_1" aria-expanded="false" aria-controls="job_list___sub_collapse_108_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_108_1"><button class="btn btn-outline-success"><span class="job_id">108 : Job ID dffd46d3978f4f2e804e2ca1456fe40d</span></button></div></a><div aria-labelledby="job_list___sub_heading_108_1" data-parent="#job_list___sub_accordion_108" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_108_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=93" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (93, 8), end pos: (93, 10)</button></a></pre><pre>operator: core/ReplaceOrWithAnd, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -90,7 +90,7 @@
 
     return (
         not session_store.expiration_time
-        or session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
+        and session_store.expiration_time &gt;= datetime.now(tz=timezone.utc)
     )
 
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

...............................FFF.F.F                                   [100%]2023-11-16 08:20:23 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:24 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
_ test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x108b79550&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x108b69990&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 32, 92657, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x108bb75d0&gt;

    def test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 600
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:172: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:27 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:27 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:27 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:27 [debug    ] loading user                   user_id=None
2023-11-16 08:20:27 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 20, 32, 92657, tzinfo=datetime.timezone.utc)
2023-11-16 08:20:27 [info     ] session does not exist
________________________________ test_load_user ________________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x105853890&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x1057d8210&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 32, 91272, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x105816e50&gt;

    def test_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create(
                "eq_session_id",
                "user_id",
                session_data,
                expires_at,
            )
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:71: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:27 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:27 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:27 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:27 [debug    ] loading user                   user_id=None
2023-11-16 08:20:27 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 20, 32, 91272, tzinfo=datetime.timezone.utc)
2023-11-16 08:20:27 [info     ] session does not exist
__________________ test_check_session_with_user_id_in_session __________________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x114a8edd0&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x114a8eed0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 32, 96331, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x114a51a10&gt;

    def test_check_session_with_user_id_in_session(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = load_user()
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:30: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:27 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:27 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:27 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:27 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 20, 32, 96331, tzinfo=datetime.timezone.utc)
2023-11-16 08:20:27 [info     ] session does not exist
_ test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x11070b810&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x11070bd10&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 32, 129033, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x11073d8d0&gt;

    def test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different(
        app: Flask,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store", return_value=session_store
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
            cookie_session["expires_in"] = 5
    
            # When
            user = user_loader(None)
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:146: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:27 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:27 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:27 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:27 [debug    ] loading user                   user_id=None
2023-11-16 08:20:27 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 20, 32, 129033, tzinfo=datetime.timezone.utc)
2023-11-16 08:20:27 [info     ] session does not exist
____________________________ test_request_load_user ____________________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
session_store = &lt;app.data_models.session_store.SessionStore object at 0x10588ca90&gt;
session_data = &lt;app.data_models.session_data.SessionData object at 0x10588c6d0&gt;
expires_at = datetime.datetime(2023, 11, 16, 8, 20, 32, 312959, tzinfo=datetime.timezone.utc)
mocker = &lt;pytest_mock.plugin.MockerFixture object at 0x105814f90&gt;

    def test_request_load_user(
        app,
        session_store,
        session_data,
        expires_at,
        mocker,
    ):
        mocker.patch(
            "app.authentication.authenticator.get_session_store",
            return_value=session_store,
        )
        with app.app_context():
            # Given
            session_store.create("eq_session_id", "user_id", session_data, expires_at)
            cookie_session[USER_IK] = "user_ik"
    
            # When
            user = request_load_user(mocker.Mock(Request))
    
            # Then
&gt;           assert user.user_id == "user_id"
E           AttributeError: 'NoneType' object has no attribute 'user_id'

tests/app/authentication/test_authenticator.py:95: AttributeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:20:27 [info     ] starting eq survey runner      version=local

2023-11-16 08:20:27 [debug    ] finding eq_session_id in database eq_session_id=eq_session_id
2023-11-16 08:20:27 [debug    ] eq_session_id not found in database eq_session_id=eq_session_id
----------------------------- Captured stdout call -----------------------------
2023-11-16 08:20:27 [debug    ] load user
2023-11-16 08:20:27 [info     ] session has expired            session_expiry=datetime.datetime(2023, 11, 16, 8, 20, 32, 312959, tzinfo=datetime.timezone.utc)
2023-11-16 08:20:27 [info     ] session does not exist
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_load_user - Attri...
FAILED tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
FAILED tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
FAILED tests/app/authentication/test_authenticator.py::test_request_load_user
================== 5 failed, 33 passed, 325 warnings in 4.04s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_109"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_109_1" aria-expanded="false" aria-controls="job_list___sub_collapse_109_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_109_1"><button class="btn btn-outline-danger"><span class="job_id">109 : Job ID 2793ae7b75474e0dadc8ced5d3b74028</span></button></div></a><div aria-labelledby="job_list___sub_heading_109_1" data-parent="#job_list___sub_accordion_109" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_109_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=77" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (77, 14), end pos: (77, 16)</button></a></pre><pre>operator: core/NumberReplacer, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -74,7 +74,7 @@
         if (
             not session_store.expiration_time
             or (new_expiration_time - session_store.expiration_time).total_seconds()
-            &gt; 60
+            &gt; 61
         ):
             session_store.expiration_time = new_expiration_time
             session_store.save()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:20:28 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:29 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.98s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_110"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_110_1" aria-expanded="false" aria-controls="job_list___sub_collapse_110_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_110_1"><button class="btn btn-outline-danger"><span class="job_id">110 : Job ID 7cbc052c130440ee89100a8595fb3064</span></button></div></a><div aria-labelledby="job_list___sub_heading_110_1" data-parent="#job_list___sub_accordion_110" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_110_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=77" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (77, 14), end pos: (77, 16)</button></a></pre><pre>operator: core/NumberReplacer, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -74,7 +74,7 @@
         if (
             not session_store.expiration_time
             or (new_expiration_time - session_store.expiration_time).total_seconds()
-            &gt; 60
+            &gt; 59
         ):
             session_store.expiration_time = new_expiration_time
             session_store.save()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:20:34 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:34 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 4.09s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_111"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_111_1" aria-expanded="false" aria-controls="job_list___sub_collapse_111_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_111_1"><button class="btn btn-outline-danger"><span class="job_id">111 : Job ID 11a48b27922842688bf8a8ab0c2a907c</span></button></div></a><div aria-labelledby="job_list___sub_heading_111_1" data-parent="#job_list___sub_accordion_111" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_111_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=32" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (32, 0), end pos: (33, 0)</button></a></pre><pre>operator: core/RemoveDecorator, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -27,9 +27,6 @@
 logger = get_logger()
 
 login_manager = LoginManager()
-
-
-@login_manager.user_loader
 def user_loader(user_id: str) -&gt; Optional[str]:
     logger.debug("loading user", user_id=user_id)
     return load_user()</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:20:39 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:40 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.90s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_112"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_112_1" aria-expanded="false" aria-controls="job_list___sub_collapse_112_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_112_1"><button class="btn btn-outline-danger"><span class="job_id">112 : Job ID 438adb32a7ce49348ddc3f862521eb03</span></button></div></a><div aria-labelledby="job_list___sub_heading_112_1" data-parent="#job_list___sub_accordion_112" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_112_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=38" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (38, 0), end pos: (39, 0)</button></a></pre><pre>operator: core/RemoveDecorator, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -33,9 +33,6 @@
 def user_loader(user_id: str) -&gt; Optional[str]:
     logger.debug("loading user", user_id=user_id)
     return load_user()
-
-
-@login_manager.request_loader
 def request_load_user(
     request: Request,  # pylint: disable=unused-argument
 ) -&gt; Optional[User]:</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:20:45 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:45 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.89s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_113"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_113_1" aria-expanded="false" aria-controls="job_list___sub_collapse_113_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_113_1"><button class="btn btn-outline-danger"><span class="job_id">113 : Job ID 885db0b3002045ee8b843478e6bcc095</span></button></div></a><div aria-labelledby="job_list___sub_heading_113_1" data-parent="#job_list___sub_accordion_113" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_113_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=51" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (51, 0), end pos: (52, 0)</button></a></pre><pre>operator: core/RemoveDecorator, occurrence: 2</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -46,9 +46,6 @@
     )
 
     return load_user(extend_session=extend_session)
-
-
-@user_logged_out.connect_via(ANY)
 def when_user_logged_out(
     sender_app: Flask, user: str  # pylint: disable=unused-argument
 ) -&gt; None:</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:20:50 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:51 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.79s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_114"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_114_1" aria-expanded="false" aria-controls="job_list___sub_collapse_114_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_114_1"><button class="btn btn-outline-danger"><span class="job_id">114 : Job ID 73bc9320b07149cf9e6beee27caf5da5</span></button></div></a><div aria-labelledby="job_list___sub_heading_114_1" data-parent="#job_list___sub_accordion_114" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_114_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/authenticator.py&amp;line=145" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/authenticator.py, start pos: (145, 0), end pos: (146, 0)</button></a></pre><pre>operator: core/RemoveDecorator, occurrence: 3</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/authenticator.py
+++ bapp/authentication/authenticator.py
@@ -140,9 +140,6 @@
     return SessionData(
         language_code=metadata.get("language_code"),
     )
-
-
-@contextmanager
 def create_session_questionnaire_store(
     metadata: MutableMapping,
 ) -&gt; Generator[QuestionnaireStore, None, None]:</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:20:55 [debug    ] reading from file              filename=.application-version
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:20:56 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.91s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_115"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_115_1" aria-expanded="false" aria-controls="job_list___sub_collapse_115_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_115_1"><button class="btn btn-outline-success"><span class="job_id">115 : Job ID 1cda20e91e024186bda20dd4f4474230</span></button></div></a><div aria-labelledby="job_list___sub_heading_115_1" data-parent="#job_list___sub_accordion_115" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_115_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=31" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (31, 17), end pos: (31, 19)</button></a></pre><pre>operator: core/ReplaceComparisonOperator_Is_IsNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -28,7 +28,7 @@
     :raises TypeError: when jti_claim is not a valid uuid4.
     :raises JtiTokenUsed: when jti_claim has already been used.
     """
-    if jti_claim is None:
+    if jti_claim is not None:
         raise ValueError
     if not is_valid_uuid4(jti_claim):
         logger.info("jti claim is invalid", jti_claim=jti_claim)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

................................F.FF.F                                   [100%]2023-11-16 08:21:01 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:01 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________________ test_should_raise_type_error_invalid_uuid ___________________
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_should_raise_type_error_invalid_uuid():
        jti_token = "jti_token"
        expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
        with pytest.raises(TypeError):
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:53: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = 'jti_token'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 5, 113551, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is not None:
&gt;           raise ValueError
E           ValueError

app/authentication/jti_claim_storage.py:32: ValueError
_____________________ test_should_return_raise_value_error _____________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_should_return_raise_value_error():
        # Given
        token = None
        expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
        # When
        with pytest.raises(ValueError):
&gt;           use_jti_claim(token, expires_at)

tests/app/authentication/test_use_token.py:30: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/jti_claim_storage.py:33: in use_jti_claim
    if not is_valid_uuid4(jti_claim):
app/helpers/uuid_helper.py:6: in is_valid_uuid4
    UUID(uuid_string, version=4)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;[AttributeError("'UUID' object has no attribute 'int'") raised in repr()] UUID object at 0x10d5ae740&gt;
hex = None, bytes = None, bytes_le = None, fields = None, int = None
version = 4

    def __init__(self, hex=None, bytes=None, bytes_le=None, fields=None,
                       int=None, version=None,
                       *, is_safe=SafeUUID.unknown):
        r"""Create a UUID from either a string of 32 hexadecimal digits,
        a string of 16 bytes as the 'bytes' argument, a string of 16 bytes
        in little-endian order as the 'bytes_le' argument, a tuple of six
        integers (32-bit time_low, 16-bit time_mid, 16-bit time_hi_version,
        8-bit clock_seq_hi_variant, 8-bit clock_seq_low, 48-bit node) as
        the 'fields' argument, or a single 128-bit integer as the 'int'
        argument.  When a string of hex digits is given, curly braces,
        hyphens, and a URN prefix are all optional.  For example, these
        expressions all yield the same UUID:
    
        UUID('{12345678-1234-5678-1234-567812345678}')
        UUID('12345678123456781234567812345678')
        UUID('urn:uuid:12345678-1234-5678-1234-567812345678')
        UUID(bytes='\x12\x34\x56\x78'*4)
        UUID(bytes_le='\x78\x56\x34\x12\x34\x12\x78\x56' +
                      '\x12\x34\x56\x78\x12\x34\x56\x78')
        UUID(fields=(0x12345678, 0x1234, 0x5678, 0x12, 0x34, 0x567812345678))
        UUID(int=0x12345678123456781234567812345678)
    
        Exactly one of 'hex', 'bytes', 'bytes_le', 'fields', or 'int' must
        be given.  The 'version' argument is optional; if given, the resulting
        UUID will have its variant and version set according to RFC 4122,
        overriding the given 'hex', 'bytes', 'bytes_le', 'fields', or 'int'.
    
        is_safe is an enum exposed as an attribute on the instance.  It
        indicates whether the UUID has been generated in a way that is safe
        for multiprocessing applications, via uuid_generate_time_safe(3).
        """
    
        if [hex, bytes, bytes_le, fields, int].count(None) != 4:
&gt;           raise TypeError('one of the hex, bytes, bytes_le, fields, '
                            'or int arguments must be given')
E           TypeError: one of the hex, bytes, bytes_le, fields, or int arguments must be given

../../.pyenv/versions/3.11.4/lib/python3.11/uuid.py:172: TypeError
____________________________ test_should_use_token _____________________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4441876304'&gt;

    def test_should_use_token(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = 'cd3ca41b-9c3a-4cd2-b69d-ef88b34ba1ef'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 5, 164846, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is not None:
&gt;           raise ValueError
E           ValueError

app/authentication/jti_claim_storage.py:32: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:05 [info     ] starting eq survey runner      version=local

__________ test_should_raise_jti_token_used_when_token_already_exists __________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4442552336'&gt;

    def test_should_raise_jti_token_used_when_token_already_exists(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
            with pytest.raises(JtiTokenUsed) as excinfo:
                mock_redis_put.side_effect = [ItemAlreadyExistsError()]
&gt;               use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = '610b60bf-24dc-4bc4-8766-6cddd9fb7f29'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 5, 479108, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is not None:
&gt;           raise ValueError
E           ValueError

app/authentication/jti_claim_storage.py:32: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:05 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_use_token.py::test_should_raise_type_error_invalid_uuid
FAILED tests/app/authentication/test_use_token.py::test_should_return_raise_value_error
FAILED tests/app/authentication/test_use_token.py::test_should_use_token - Va...
FAILED tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
================== 4 failed, 34 passed, 325 warnings in 4.34s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_116"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_116_1" aria-expanded="false" aria-controls="job_list___sub_collapse_116_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_116_1"><button class="btn btn-outline-success"><span class="job_id">116 : Job ID bf3d949523ed4fcc9be73c308c6b85f0</span></button></div></a><div aria-labelledby="job_list___sub_heading_116_1" data-parent="#job_list___sub_accordion_116" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_116_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=33" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (33, 7), end pos: (33, 10)</button></a></pre><pre>operator: core/ReplaceUnaryOperator_Delete_Not, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -30,7 +30,7 @@
     """
     if jti_claim is None:
         raise ValueError
-    if not is_valid_uuid4(jti_claim):
+    if  is_valid_uuid4(jti_claim):
         logger.info("jti claim is invalid", jti_claim=jti_claim)
         raise TypeError
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

.................................FFF..                                   [100%]2023-11-16 08:21:07 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:07 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________________ test_should_raise_type_error_invalid_uuid ___________________
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_should_raise_type_error_invalid_uuid():
        jti_token = "jti_token"
        expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
        with pytest.raises(TypeError):
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:53: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/jti_claim_storage.py:42: in use_jti_claim
    current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/werkzeug/local.py:311: in __get__
    obj = instance._get_current_object()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

    def _get_current_object() -&gt; T:
        try:
            obj = local.get()
        except LookupError:
&gt;           raise RuntimeError(unbound_message) from None
E           RuntimeError: Working outside of application context.
E           
E           This typically means that you attempted to use functionality that needed
E           the current application. To solve this, set up an application context
E           with app.app_context(). See the documentation for more information.

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/werkzeug/local.py:508: RuntimeError
__________ test_should_raise_jti_token_used_when_token_already_exists __________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4400174672'&gt;

    def test_should_raise_jti_token_used_when_token_already_exists(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
            with pytest.raises(JtiTokenUsed) as excinfo:
                mock_redis_put.side_effect = [ItemAlreadyExistsError()]
&gt;               use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = '3498cce7-b839-4c0d-aa50-20f8ef7dd249'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 11, 34021, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is None:
            raise ValueError
        if  is_valid_uuid4(jti_claim):
            logger.info("jti claim is invalid", jti_claim=jti_claim)
&gt;           raise TypeError
E           TypeError

app/authentication/jti_claim_storage.py:35: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:11 [info     ] starting eq survey runner      version=local

----------------------------- Captured stdout call -----------------------------
2023-11-16 08:21:11 [info     ] jti claim is invalid           jti_claim=3498cce7-b839-4c0d-aa50-20f8ef7dd249
____________________________ test_should_use_token _____________________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4400805904'&gt;

    def test_should_use_token(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = 'eae8371e-8d7a-4585-8b99-accedadc7d4b'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 11, 25448, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is None:
            raise ValueError
        if  is_valid_uuid4(jti_claim):
            logger.info("jti claim is invalid", jti_claim=jti_claim)
&gt;           raise TypeError
E           TypeError

app/authentication/jti_claim_storage.py:35: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:10 [info     ] starting eq survey runner      version=local

----------------------------- Captured stdout call -----------------------------
2023-11-16 08:21:11 [info     ] jti claim is invalid           jti_claim=eae8371e-8d7a-4585-8b99-accedadc7d4b
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_use_token.py::test_should_raise_type_error_invalid_uuid
FAILED tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
FAILED tests/app/authentication/test_use_token.py::test_should_use_token - Ty...
================== 3 failed, 35 passed, 325 warnings in 4.12s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_117"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_117_1" aria-expanded="false" aria-controls="job_list___sub_collapse_117_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_117_1"><button class="btn btn-outline-success"><span class="job_id">117 : Job ID 81578ac01ec44a51bb9aabf7c1c50cc2</span></button></div></a><div aria-labelledby="job_list___sub_heading_117_1" data-parent="#job_list___sub_accordion_117" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_117_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=31" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (31, 7), end pos: (31, 24)</button></a></pre><pre>operator: core/AddNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -28,7 +28,7 @@
     :raises TypeError: when jti_claim is not a valid uuid4.
     :raises JtiTokenUsed: when jti_claim has already been used.
     """
-    if jti_claim is None:
+    if not jti_claim is None:
         raise ValueError
     if not is_valid_uuid4(jti_claim):
         logger.info("jti claim is invalid", jti_claim=jti_claim)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

..............................F.F.FF..                                   [100%]2023-11-16 08:21:12 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:13 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________________ test_should_raise_type_error_invalid_uuid ___________________
[gw8] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_should_raise_type_error_invalid_uuid():
        jti_token = "jti_token"
        expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
        with pytest.raises(TypeError):
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:53: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = 'jti_token'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 16, 516419, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if not jti_claim is None:
&gt;           raise ValueError
E           ValueError

app/authentication/jti_claim_storage.py:32: ValueError
_____________________ test_should_return_raise_value_error _____________________
[gw4] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_should_return_raise_value_error():
        # Given
        token = None
        expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
        # When
        with pytest.raises(ValueError):
&gt;           use_jti_claim(token, expires_at)

tests/app/authentication/test_use_token.py:30: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/jti_claim_storage.py:33: in use_jti_claim
    if not is_valid_uuid4(jti_claim):
app/helpers/uuid_helper.py:6: in is_valid_uuid4
    UUID(uuid_string, version=4)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;[AttributeError("'UUID' object has no attribute 'int'") raised in repr()] UUID object at 0x10be96b80&gt;
hex = None, bytes = None, bytes_le = None, fields = None, int = None
version = 4

    def __init__(self, hex=None, bytes=None, bytes_le=None, fields=None,
                       int=None, version=None,
                       *, is_safe=SafeUUID.unknown):
        r"""Create a UUID from either a string of 32 hexadecimal digits,
        a string of 16 bytes as the 'bytes' argument, a string of 16 bytes
        in little-endian order as the 'bytes_le' argument, a tuple of six
        integers (32-bit time_low, 16-bit time_mid, 16-bit time_hi_version,
        8-bit clock_seq_hi_variant, 8-bit clock_seq_low, 48-bit node) as
        the 'fields' argument, or a single 128-bit integer as the 'int'
        argument.  When a string of hex digits is given, curly braces,
        hyphens, and a URN prefix are all optional.  For example, these
        expressions all yield the same UUID:
    
        UUID('{12345678-1234-5678-1234-567812345678}')
        UUID('12345678123456781234567812345678')
        UUID('urn:uuid:12345678-1234-5678-1234-567812345678')
        UUID(bytes='\x12\x34\x56\x78'*4)
        UUID(bytes_le='\x78\x56\x34\x12\x34\x12\x78\x56' +
                      '\x12\x34\x56\x78\x12\x34\x56\x78')
        UUID(fields=(0x12345678, 0x1234, 0x5678, 0x12, 0x34, 0x567812345678))
        UUID(int=0x12345678123456781234567812345678)
    
        Exactly one of 'hex', 'bytes', 'bytes_le', 'fields', or 'int' must
        be given.  The 'version' argument is optional; if given, the resulting
        UUID will have its variant and version set according to RFC 4122,
        overriding the given 'hex', 'bytes', 'bytes_le', 'fields', or 'int'.
    
        is_safe is an enum exposed as an attribute on the instance.  It
        indicates whether the UUID has been generated in a way that is safe
        for multiprocessing applications, via uuid_generate_time_safe(3).
        """
    
        if [hex, bytes, bytes_le, fields, int].count(None) != 4:
&gt;           raise TypeError('one of the hex, bytes, bytes_le, fields, '
                            'or int arguments must be given')
E           TypeError: one of the hex, bytes, bytes_le, fields, or int arguments must be given

../../.pyenv/versions/3.11.4/lib/python3.11/uuid.py:172: TypeError
__________ test_should_raise_jti_token_used_when_token_already_exists __________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4525226576'&gt;

    def test_should_raise_jti_token_used_when_token_already_exists(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
            with pytest.raises(JtiTokenUsed) as excinfo:
                mock_redis_put.side_effect = [ItemAlreadyExistsError()]
&gt;               use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = '5bed60da-8d90-4cf9-afb1-d71fd9e776ba'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 16, 563790, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if not jti_claim is None:
&gt;           raise ValueError
E           ValueError

app/authentication/jti_claim_storage.py:32: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:16 [info     ] starting eq survey runner      version=local

____________________________ test_should_use_token _____________________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4646773584'&gt;

    def test_should_use_token(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = '115e58fc-d0be-455c-a1ae-4b0c0c545c1b'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 16, 562606, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if not jti_claim is None:
&gt;           raise ValueError
E           ValueError

app/authentication/jti_claim_storage.py:32: ValueError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:16 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_use_token.py::test_should_raise_type_error_invalid_uuid
FAILED tests/app/authentication/test_use_token.py::test_should_return_raise_value_error
FAILED tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
FAILED tests/app/authentication/test_use_token.py::test_should_use_token - Va...
================== 4 failed, 34 passed, 325 warnings in 4.02s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_118"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_118_1" aria-expanded="false" aria-controls="job_list___sub_collapse_118_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_118_1"><button class="btn btn-outline-success"><span class="job_id">118 : Job ID f6735c5d417846648618b2e2db2f3a6a</span></button></div></a><div aria-labelledby="job_list___sub_heading_118_1" data-parent="#job_list___sub_accordion_118" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_118_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=33" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (33, 7), end pos: (33, 36)</button></a></pre><pre>operator: core/AddNot, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -30,7 +30,7 @@
     """
     if jti_claim is None:
         raise ValueError
-    if not is_valid_uuid4(jti_claim):
+    if not not is_valid_uuid4(jti_claim):
         logger.info("jti claim is invalid", jti_claim=jti_claim)
         raise TypeError
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

................................F.F.F.                                   [100%]2023-11-16 08:21:18 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:18 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________________ test_should_raise_type_error_invalid_uuid ___________________
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

    def test_should_raise_type_error_invalid_uuid():
        jti_token = "jti_token"
        expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
        with pytest.raises(TypeError):
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:53: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
app/authentication/jti_claim_storage.py:42: in use_jti_claim
    current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/werkzeug/local.py:311: in __get__
    obj = instance._get_current_object()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

    def _get_current_object() -&gt; T:
        try:
            obj = local.get()
        except LookupError:
&gt;           raise RuntimeError(unbound_message) from None
E           RuntimeError: Working outside of application context.
E           
E           This typically means that you attempted to use functionality that needed
E           the current application. To solve this, set up an application context
E           with app.app_context(). See the documentation for more information.

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/werkzeug/local.py:508: RuntimeError
____________________________ test_should_use_token _____________________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4552946448'&gt;

    def test_should_use_token(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
&gt;           use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = '4f940ae6-5f38-49fe-ac65-338181461d29'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 22, 98595, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is None:
            raise ValueError
        if not not is_valid_uuid4(jti_claim):
            logger.info("jti claim is invalid", jti_claim=jti_claim)
&gt;           raise TypeError
E           TypeError

app/authentication/jti_claim_storage.py:35: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:22 [info     ] starting eq survey runner      version=local

----------------------------- Captured stdout call -----------------------------
2023-11-16 08:21:22 [info     ] jti claim is invalid           jti_claim=4f940ae6-5f38-49fe-ac65-338181461d29
__________ test_should_raise_jti_token_used_when_token_already_exists __________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4532347920'&gt;

    def test_should_raise_jti_token_used_when_token_already_exists(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
            with pytest.raises(JtiTokenUsed) as excinfo:
                mock_redis_put.side_effect = [ItemAlreadyExistsError()]
&gt;               use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = 'ddf2edef-2680-4710-8429-80edf04c2adb'
expires_at = datetime.datetime(2023, 11, 16, 8, 22, 22, 110434, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is None:
            raise ValueError
        if not not is_valid_uuid4(jti_claim):
            logger.info("jti claim is invalid", jti_claim=jti_claim)
&gt;           raise TypeError
E           TypeError

app/authentication/jti_claim_storage.py:35: TypeError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:22 [info     ] starting eq survey runner      version=local

----------------------------- Captured stdout call -----------------------------
2023-11-16 08:21:22 [info     ] jti claim is invalid           jti_claim=ddf2edef-2680-4710-8429-80edf04c2adb
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_use_token.py::test_should_raise_type_error_invalid_uuid
FAILED tests/app/authentication/test_use_token.py::test_should_use_token - Ty...
FAILED tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
================== 3 failed, 35 passed, 325 warnings in 4.20s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_119"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_119_1" aria-expanded="false" aria-controls="job_list___sub_collapse_119_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_119_1"><button class="btn btn-outline-danger"><span class="job_id">119 : Job ID d176f3b7d4944620b249dee7c61e2461</span></button></div></a><div aria-labelledby="job_list___sub_heading_119_1" data-parent="#job_list___sub_accordion_119" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_119_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=42" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (42, 63), end pos: (42, 68)</button></a></pre><pre>operator: core/ReplaceFalseWithTrue, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -39,7 +39,7 @@
         expires_at += timedelta(seconds=60)
 
         jti = UsedJtiClaim(jti_claim, expires_at)
-        current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore
+        current_app.eq["ephemeral_storage"].put(jti, overwrite=True)  # type: ignore
     except ItemAlreadyExistsError as e:
         logger.error("jti claim has already been used", jti_claim=jti_claim)
         raise JtiTokenUsed(jti_claim) from e</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:21:23 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:24 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.96s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_120"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_120_1" aria-expanded="false" aria-controls="job_list___sub_collapse_120_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_120_1"><button class="btn btn-outline-success"><span class="job_id">120 : Job ID e94c6a1dbb6848ddacb3c45d9b140b92</span></button></div></a><div aria-labelledby="job_list___sub_heading_120_1" data-parent="#job_list___sub_accordion_120" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_120_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=43" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (43, 11), end pos: (43, 33)</button></a></pre><pre>operator: core/ExceptionReplacer, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -40,7 +40,7 @@
 
         jti = UsedJtiClaim(jti_claim, expires_at)
         current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore
-    except ItemAlreadyExistsError as e:
+    except CosmicRayTestingException as e:
         logger.error("jti claim has already been used", jti_claim=jti_claim)
         raise JtiTokenUsed(jti_claim) from e
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

....................................F.                                   [100%]2023-11-16 08:21:29 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:29 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________ test_should_raise_jti_token_used_when_token_already_exists __________
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

jti_claim = 'e554cb7b-1337-4d7c-9726-dd9e763d0ebb'
expires_at = datetime.datetime(2023, 11, 16, 8, 23, 33, 213596, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is None:
            raise ValueError
        if not is_valid_uuid4(jti_claim):
            logger.info("jti claim is invalid", jti_claim=jti_claim)
            raise TypeError
    
        try:
            # Make claim expire a little later than exp to avoid race conditions with out of sync clocks.
            expires_at += timedelta(seconds=60)
    
            jti = UsedJtiClaim(jti_claim, expires_at)
&gt;           current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore

app/authentication/jti_claim_storage.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.pyenv/versions/3.11.4/lib/python3.11/unittest/mock.py:1124: in __call__
    return self._mock_call(*args, **kwargs)
../../.pyenv/versions/3.11.4/lib/python3.11/unittest/mock.py:1128: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;MagicMock name='put' id='4543073552'&gt;
args = (&lt;app.data_models.app_models.UsedJtiClaim object at 0x10ec65b10&gt;,)
kwargs = {'overwrite': False}, effect = &lt;list_iterator object at 0x10ea64040&gt;
result = ItemAlreadyExistsError()

    def _execute_mock_call(self, /, *args, **kwargs):
        # separate from _increment_mock_call so that awaited functions are
        # executed separately from their call, also AsyncMock overrides this method
    
        effect = self.side_effect
        if effect is not None:
            if _is_exception(effect):
                raise effect
            elif not _callable(effect):
                result = next(effect)
                if _is_exception(result):
&gt;                   raise result
E                   app.storage.errors.ItemAlreadyExistsError

../../.pyenv/versions/3.11.4/lib/python3.11/unittest/mock.py:1187: ItemAlreadyExistsError

During handling of the above exception, another exception occurred:

app = &lt;Flask 'app.setup'&gt;
mock_redis_put = &lt;MagicMock name='put' id='4543073552'&gt;

    def test_should_raise_jti_token_used_when_token_already_exists(app, mock_redis_put):
        with app.app_context():
            # Given
            jti_token = str(uuid4())
            expires_at = datetime.now(tz=timezone.utc) + timedelta(seconds=60)
    
            # When
            with pytest.raises(JtiTokenUsed) as excinfo:
                mock_redis_put.side_effect = [ItemAlreadyExistsError()]
&gt;               use_jti_claim(jti_token, expires_at)

tests/app/authentication/test_use_token.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

jti_claim = 'e554cb7b-1337-4d7c-9726-dd9e763d0ebb'
expires_at = datetime.datetime(2023, 11, 16, 8, 23, 33, 213596, tzinfo=datetime.timezone.utc)

    def use_jti_claim(jti_claim: str, expires_at: datetime) -&gt; None:
        """
        Use a jti claim
        :param jti_claim: jti claim to mark as used.
        :param expires_at: the datetime at which the jti claim expires.
        :raises ValueError: when jti_claim is None.
        :raises TypeError: when jti_claim is not a valid uuid4.
        :raises JtiTokenUsed: when jti_claim has already been used.
        """
        if jti_claim is None:
            raise ValueError
        if not is_valid_uuid4(jti_claim):
            logger.info("jti claim is invalid", jti_claim=jti_claim)
            raise TypeError
    
        try:
            # Make claim expire a little later than exp to avoid race conditions with out of sync clocks.
            expires_at += timedelta(seconds=60)
    
            jti = UsedJtiClaim(jti_claim, expires_at)
            current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore
&gt;       except CosmicRayTestingException as e:
E       NameError: name 'CosmicRayTestingException' is not defined

app/authentication/jti_claim_storage.py:43: NameError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:21:33 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
================== 1 failed, 37 passed, 325 warnings in 4.19s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_121"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_121_1" aria-expanded="false" aria-controls="job_list___sub_collapse_121_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_121_1"><button class="btn btn-outline-danger"><span class="job_id">121 : Job ID ded84a0b0d5e46f28f16866e2995f045</span></button></div></a><div aria-labelledby="job_list___sub_heading_121_1" data-parent="#job_list___sub_accordion_121" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_121_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=39" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (39, 40), end pos: (39, 42)</button></a></pre><pre>operator: core/NumberReplacer, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -36,7 +36,7 @@
 
     try:
         # Make claim expire a little later than exp to avoid race conditions with out of sync clocks.
-        expires_at += timedelta(seconds=60)
+        expires_at += timedelta(seconds= 61)
 
         jti = UsedJtiClaim(jti_claim, expires_at)
         current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:21:35 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:35 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 4.15s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_122"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_122_1" aria-expanded="false" aria-controls="job_list___sub_collapse_122_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-danger" id="job_list___sub_heading_122_1"><button class="btn btn-outline-danger"><span class="job_id">122 : Job ID 87c4553d202546519003d4fa5e8b0074</span></button></div></a><div aria-labelledby="job_list___sub_heading_122_1" data-parent="#job_list___sub_accordion_122" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_122_1"><div class="card-body"><div class="work-item"><div class="alert alert-danger test-outcome" role="alert"><p>SURVIVED</p><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.SURVIVED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/jti_claim_storage.py&amp;line=39" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/jti_claim_storage.py, start pos: (39, 40), end pos: (39, 42)</button></a></pre><pre>operator: core/NumberReplacer, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/jti_claim_storage.py
+++ bapp/authentication/jti_claim_storage.py
@@ -36,7 +36,7 @@
 
     try:
         # Make claim expire a little later than exp to avoid race conditions with out of sync clocks.
-        expires_at += timedelta(seconds=60)
+        expires_at += timedelta(seconds= 59)
 
         jti = UsedJtiClaim(jti_claim, expires_at)
         current_app.eq["ephemeral_storage"].put(jti, overwrite=False)  # type: ignore</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

......................................                                   [100%]2023-11-16 08:21:40 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:41 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 38 passed, 325 warnings in 3.97s =======================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_123"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_123_1" aria-expanded="false" aria-controls="job_list___sub_collapse_123_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_123_1"><button class="btn btn-outline-success"><span class="job_id">123 : Job ID fdce1cc221e84915b1ad8e44a5da1d60</span></button></div></a><div aria-labelledby="job_list___sub_heading_123_1" data-parent="#job_list___sub_accordion_123" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_123_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/roles.py&amp;line=33" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/roles.py, start pos: (33, 15), end pos: (33, 53)</button></a></pre><pre>operator: core/AddNot, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/roles.py
+++ bapp/authentication/roles.py
@@ -30,7 +30,7 @@
         @wraps(func)
         def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
             roles: list = []
-            if metadata := get_metadata(current_user):
+            if not metadata := get_metadata(current_user):
                 roles = metadata.roles or []
 
             if current_user.is_authenticated and role in roles:</pre></div><div class="alert alert-secondary"><pre class="diff">ImportError while loading conftest '/Users/liamtoozer/eq/eq-questionnaire-runner/tests/app/conftest.py'.
tests/app/conftest.py:28: in &lt;module&gt;
    from app.setup import create_app
app/setup.py:33: in &lt;module&gt;
    from app.routes.dump import dump_blueprint
app/routes/dump.py:4: in &lt;module&gt;
    from app.authentication.roles import role_required
E     File "/Users/liamtoozer/eq/eq-questionnaire-runner/app/authentication/roles.py", line 33
E       if not metadata := get_metadata(current_user):
E          ^^^^^^^^^^^^
E   SyntaxError: cannot use assignment expressions with expression
2023-11-16 08:21:46 [debug    ] reading from file              filename=.application-version
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_124"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_124_1" aria-expanded="false" aria-controls="job_list___sub_collapse_124_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_124_1"><button class="btn btn-outline-success"><span class="job_id">124 : Job ID aa9fd674834d47a4993e8f1b63edea45</span></button></div></a><div aria-labelledby="job_list___sub_heading_124_1" data-parent="#job_list___sub_accordion_124" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_124_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/roles.py&amp;line=36" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/roles.py, start pos: (36, 15), end pos: (36, 62)</button></a></pre><pre>operator: core/AddNot, occurrence: 1</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/roles.py
+++ bapp/authentication/roles.py
@@ -33,7 +33,7 @@
             if metadata := get_metadata(current_user):
                 roles = metadata.roles or []
 
-            if current_user.is_authenticated and role in roles:
+            if not current_user.is_authenticated and role in roles:
                 return func(*args, **kwargs)
             raise Forbidden
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

............................FFF.FF.FF.                                   [100%]2023-11-16 08:21:47 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:47 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
____ test_role_required_authenticated_with_metadata_matching_multiple_role _____
[gw8] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4481376080'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4481263696'&gt;

    def test_role_required_authenticated_with_metadata_matching_multiple_role(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated but my metadata contains multiples roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function with role_required, specifying a
        # role that is listed in the metadata roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda: "other was called")
    
        # When I call the decorated function
        # Then the function is executed and returns a value
&gt;       assert wrapped_func() == "other was called"

tests/app/authentication/test_roles.py:144: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (), kwargs = {}, roles = ['flusher', 'other', 'dumper']
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles or []
    
        if not current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
_ test_role_required_unauthenticated_wrapped_with_positional_and_keyword_arguments _
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4433446928'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4464980944'&gt;

    def test_role_required_unauthenticated_wrapped_with_positional_and_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am not authenticated
        mock_current_user.is_authenticated = False
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with keyword arguments
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:262: Failed
_________ test_role_required_authenticated_with_metadata_matching_role _________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4455793616'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4425948048'&gt;

    def test_role_required_authenticated_with_metadata_matching_role(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains a single role.
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata({"roles": ["dumper"]})
    
        # And I have decorated a function with role_required, specifying a
        # role that is listed in the metadata roles list.
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "single was called")
    
        # When I call the decorated function
        # Then the function is executed and returns a value
&gt;       assert wrapped_func() == "single was called"

tests/app/authentication/test_roles.py:125: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (), kwargs = {}, roles = ['dumper']
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co... schema_url=None, schema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles or []
    
        if not current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
______________ test_role_required_wrapped_with_keyword_arguments _______________
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4549739024'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4517992848'&gt;

    def test_role_required_wrapped_with_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1=None, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with arguments
        # Then the function is executed and returns the arguments supplied
&gt;       assert wrapped_func(arg1="y", arg2="z") == ["y", "z"]

tests/app/authentication/test_roles.py:184: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (), kwargs = {'arg1': 'y', 'arg2': 'z'}
roles = ['flusher', 'other', 'dumper']
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles or []
    
        if not current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
______ test_role_required_unauthenticated_wrapped_with_keyword_arguments _______
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4379425360'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4379416528'&gt;

    def test_role_required_unauthenticated_wrapped_with_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am not authenticated
        mock_current_user.is_authenticated = False
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1=None, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with keyword arguments
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:241: Failed
_____________ test_role_required_wrapped_with_positional_arguments _____________
[gw8] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4514482960'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4514753040'&gt;

    def test_role_required_wrapped_with_positional_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1, arg2, arg3: [arg1, arg2, arg3])
    
        # When I call the decorated function with arguments
        # Then the function is executed and returns the arguments supplied
&gt;       assert wrapped_func(1, 2, 3) == [1, 2, 3]

tests/app/authentication/test_roles.py:164: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (1, 2, 3), kwargs = {}, roles = ['flusher', 'other', 'dumper']
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles or []
    
        if not current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
_______ test_role_required_wrapped_with_positional_and_keyword_arguments _______
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4551478736'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4551481488'&gt;

    def test_role_required_wrapped_with_positional_and_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with both positional and keyword arguments
        # Then the function is executed and returns the arguments supplied
&gt;       assert wrapped_func("i", arg2=2) == ["i", 2]

tests/app/authentication/test_roles.py:204: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = ('i',), kwargs = {'arg2': 2}, roles = ['flusher', 'other', 'dumper']
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles or []
    
        if not current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_matching_multiple_role
FAILED tests/app/authentication/test_roles.py::test_role_required_unauthenticated_wrapped_with_positional_and_keyword_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_matching_role
FAILED tests/app/authentication/test_roles.py::test_role_required_wrapped_with_keyword_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_unauthenticated_wrapped_with_keyword_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_wrapped_with_positional_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_wrapped_with_positional_and_keyword_arguments
================== 7 failed, 31 passed, 325 warnings in 4.09s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_125"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_125_1" aria-expanded="false" aria-controls="job_list___sub_collapse_125_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_125_1"><button class="btn btn-outline-success"><span class="job_id">125 : Job ID 7e3efe4beffd419b83cbf8e9b653b380</span></button></div></a><div aria-labelledby="job_list___sub_heading_125_1" data-parent="#job_list___sub_accordion_125" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_125_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/roles.py&amp;line=36" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/roles.py, start pos: (36, 45), end pos: (36, 48)</button></a></pre><pre>operator: core/ReplaceAndWithOr, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/roles.py
+++ bapp/authentication/roles.py
@@ -33,7 +33,7 @@
             if metadata := get_metadata(current_user):
                 roles = metadata.roles or []
 
-            if current_user.is_authenticated and role in roles:
+            if current_user.is_authenticated or role in roles:
                 return func(*args, **kwargs)
             raise Forbidden
 </pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

............................FFF.FFFF..                                   [100%]2023-11-16 08:21:52 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:53 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________ test_role_required_authenticated_with_metadata_none_roles ___________
[gw6] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4442138704'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4442089104'&gt;

    def test_role_required_authenticated_with_metadata_none_roles(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated but my metadata contains a
        # roles list set to None
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata({"roles": None})
    
        # And I have decorated a function with role_required
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "not called")
    
        # When I call the decorated function
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:71: Failed
__________ test_role_required_authenticated_with_metadata_wrong_role ___________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4389857168'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4423224528'&gt;

    def test_role_required_authenticated_with_metadata_wrong_role(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains a single role.
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata({"roles": ["flusher"]})
    
        # And I have decorated a function with role_required, specifying a
        # role that isn't in the metadata roles list.
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "not called")
    
        # When I call the decorated function
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:107: Failed
_________________ test_role_required_authenticated_no_metadata _________________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4380834448'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4380141584'&gt;

    def test_role_required_authenticated_no_metadata(mock_get_metadata, mock_current_user):
        # Given I am authenticated but have no metadata
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = None
    
        # And I have decorated a function with role_required
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "not called")
    
        # When I call the decorated function
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:36: Failed
_ test_role_required_unauthenticated_wrapped_with_positional_and_keyword_arguments _
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4599009872'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4593977488'&gt;

    def test_role_required_unauthenticated_wrapped_with_positional_and_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am not authenticated
        mock_current_user.is_authenticated = False
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with keyword arguments
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:262: Failed
__________ test_role_required_authenticated_with_metadata_empty_roles __________
[gw6] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4442136720'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4443218192'&gt;

    def test_role_required_authenticated_with_metadata_empty_roles(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains an empty
        # roles list
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata({"roles": []})
    
        # And I have decorated a function with role_required
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "not called")
    
        # When I call the decorated function
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:89: Failed
______ test_role_required_unauthenticated_wrapped_with_keyword_arguments _______
[gw10] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4391660880'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4389983376'&gt;

    def test_role_required_unauthenticated_wrapped_with_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am not authenticated
        mock_current_user.is_authenticated = False
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1=None, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with keyword arguments
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:241: Failed
_____________ test_role_required_authenticated_with_empty_metadata _____________
[gw5] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4380706896'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4347742672'&gt;

    def test_role_required_authenticated_with_empty_metadata(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated but my metadata is empty
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = {}
    
        # And I have decorated a function with role_required
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "not called")
    
        # When I call the decorated function
        # Then a Forbidden exception is raised
&gt;       with pytest.raises(Forbidden):
E       Failed: DID NOT RAISE &lt;class 'werkzeug.exceptions.Forbidden'&gt;

tests/app/authentication/test_roles.py:53: Failed
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_none_roles
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_wrong_role
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_no_metadata
FAILED tests/app/authentication/test_roles.py::test_role_required_unauthenticated_wrapped_with_positional_and_keyword_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_empty_roles
FAILED tests/app/authentication/test_roles.py::test_role_required_unauthenticated_wrapped_with_keyword_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_empty_metadata
================== 7 failed, 31 passed, 325 warnings in 4.27s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_126"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_126_1" aria-expanded="false" aria-controls="job_list___sub_collapse_126_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_126_1"><button class="btn btn-outline-success"><span class="job_id">126 : Job ID 5d8416882fe748a480fa08f719ccb247</span></button></div></a><div aria-labelledby="job_list___sub_heading_126_1" data-parent="#job_list___sub_accordion_126" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_126_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/roles.py&amp;line=34" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/roles.py, start pos: (34, 39), end pos: (34, 41)</button></a></pre><pre>operator: core/ReplaceOrWithAnd, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/roles.py
+++ bapp/authentication/roles.py
@@ -31,7 +31,7 @@
         def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
             roles: list = []
             if metadata := get_metadata(current_user):
-                roles = metadata.roles or []
+                roles = metadata.roles and []
 
             if current_user.is_authenticated and role in roles:
                 return func(*args, **kwargs)</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

..............................FFFF..FF                                   [100%]2023-11-16 08:21:58 [debug    ] reading from file              filename=.application-version
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:21:59 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg

=================================== FAILURES ===================================
__________ test_role_required_authenticated_with_metadata_none_roles ___________
[gw6] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4522436176'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4520911952'&gt;

    def test_role_required_authenticated_with_metadata_none_roles(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated but my metadata contains a
        # roles list set to None
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata({"roles": None})
    
        # And I have decorated a function with role_required
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "not called")
    
        # When I call the decorated function
        # Then a Forbidden exception is raised
        with pytest.raises(Forbidden):
&gt;           wrapped_func()

tests/app/authentication/test_roles.py:72: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (), kwargs = {}, roles = None
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...None), schema_url=None, schema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=None)

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles and []
    
&gt;       if current_user.is_authenticated and role in roles:
E       TypeError: argument of type 'NoneType' is not iterable

app/authentication/roles.py:36: TypeError
____ test_role_required_authenticated_with_metadata_matching_multiple_role _____
[gw8] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4425194896'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4458026320'&gt;

    def test_role_required_authenticated_with_metadata_matching_multiple_role(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated but my metadata contains multiples roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function with role_required, specifying a
        # role that is listed in the metadata roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda: "other was called")
    
        # When I call the decorated function
        # Then the function is executed and returns a value
&gt;       assert wrapped_func() == "other was called"

tests/app/authentication/test_roles.py:144: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (), kwargs = {}, roles = []
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles and []
    
        if current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
______________ test_role_required_wrapped_with_keyword_arguments _______________
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4588474192'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4589250576'&gt;

    def test_role_required_wrapped_with_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1=None, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with arguments
        # Then the function is executed and returns the arguments supplied
&gt;       assert wrapped_func(arg1="y", arg2="z") == ["y", "z"]

tests/app/authentication/test_roles.py:184: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (), kwargs = {'arg1': 'y', 'arg2': 'z'}, roles = []
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles and []
    
        if current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
_________ test_role_required_authenticated_with_metadata_matching_role _________
[gw7] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4403641232'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4401943120'&gt;

    def test_role_required_authenticated_with_metadata_matching_role(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains a single role.
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata({"roles": ["dumper"]})
    
        # And I have decorated a function with role_required, specifying a
        # role that is listed in the metadata roles list.
        wrapper = role_required("dumper")
        wrapped_func = wrapper(lambda: "single was called")
    
        # When I call the decorated function
        # Then the function is executed and returns a value
&gt;       assert wrapped_func() == "single was called"

tests/app/authentication/test_roles.py:125: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (), kwargs = {}, roles = []
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co... schema_url=None, schema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles and []
    
        if current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
_____________ test_role_required_wrapped_with_positional_arguments _____________
[gw8] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4458614160'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4458690448'&gt;

    def test_role_required_wrapped_with_positional_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1, arg2, arg3: [arg1, arg2, arg3])
    
        # When I call the decorated function with arguments
        # Then the function is executed and returns the arguments supplied
&gt;       assert wrapped_func(1, 2, 3) == [1, 2, 3]

tests/app/authentication/test_roles.py:164: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (1, 2, 3), kwargs = {}, roles = []
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles and []
    
        if current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
_______ test_role_required_wrapped_with_positional_and_keyword_arguments _______
[gw9] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

mock_get_metadata = &lt;MagicMock name='get_metadata' id='4590003664'&gt;
mock_current_user = &lt;AsyncMock name='current_user' id='4590000080'&gt;

    def test_role_required_wrapped_with_positional_and_keyword_arguments(
        mock_get_metadata, mock_current_user
    ):
        # Given I am authenticated and my metadata contains roles
        mock_current_user.is_authenticated = True
        mock_get_metadata.return_value = get_metadata(
            {"roles": ["flusher", "other", "dumper"]}
        )
    
        # And I have decorated a function that takes multiple positional arguments
        # with role_required, specifying a role that is listed in the metadata
        # roles list.
        wrapper = role_required("other")
        wrapped_func = wrapper(lambda arg1, arg2=None: [arg1, arg2])
    
        # When I call the decorated function with both positional and keyword arguments
        # Then the function is executed and returns the arguments supplied
&gt;       assert wrapped_func("i", arg2=2) == ["i", 2]

tests/app/authentication/test_roles.py:204: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = ('i',), kwargs = {'arg2': 2}, roles = []
metadata = MetadataProxy(tx_id='tx_id', account_service_url='account_service_url', case_id='case_id', collection_exercise_sid='co...hema_name=None, language_code=None, channel=None, region_code=None, version=None, roles=['flusher', 'other', 'dumper'])

    @wraps(func)
    def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
        roles: list = []
        if metadata := get_metadata(current_user):
            roles = metadata.roles and []
    
        if current_user.is_authenticated and role in roles:
            return func(*args, **kwargs)
&gt;       raise Forbidden
E       werkzeug.exceptions.Forbidden: 403 Forbidden: You don't have the permission to access the requested resource. It is either read-protected or not readable by the server.

app/authentication/roles.py:38: Forbidden
=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_none_roles
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_matching_multiple_role
FAILED tests/app/authentication/test_roles.py::test_role_required_wrapped_with_keyword_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_authenticated_with_metadata_matching_role
FAILED tests/app/authentication/test_roles.py::test_role_required_wrapped_with_positional_arguments
FAILED tests/app/authentication/test_roles.py::test_role_required_wrapped_with_positional_and_keyword_arguments
================== 6 failed, 32 passed, 325 warnings in 4.30s ==================
</pre></div></div></div></div></div><div class="mb-1" id="job_list___sub_accordion_127"><div class="card"><a data-toggle="collapse" data-target="#job_list___sub_collapse_127_1" aria-expanded="false" aria-controls="job_list___sub_collapse_127_1" href="#" class="job_list___sub_multi_heading"><div role="alert" class="card-header alert-success" id="job_list___sub_heading_127_1"><button class="btn btn-outline-success"><span class="job_id">127 : Job ID 0a9e590327d3457584300784601df990</span></button></div></a><div aria-labelledby="job_list___sub_heading_127_1" data-parent="#job_list___sub_accordion_127" class="collapse job_list___sub_multi_collapse" id="job_list___sub_collapse_127_1"><div class="card-body"><div class="work-item"><div class="alert alert-success test-outcome" role="alert"><p>worker outcome: WorkerOutcome.NORMAL</p><p>test outcome: TestOutcome.KILLED</p></div></div><pre class="location"><a href="pycharm://open?file=app/authentication/roles.py&amp;line=30" class="text-secondary"><button class="btn btn-outline-dark">app/authentication/roles.py, start pos: (30, 8), end pos: (31, 0)</button></a></pre><pre>operator: core/RemoveDecorator, occurrence: 0</pre><div class="alert alert-secondary"><pre class="diff">--- mutation diff ---
--- aapp/authentication/roles.py
+++ bapp/authentication/roles.py
@@ -27,7 +27,6 @@
     """
 
     def role_required_decorator(func: Callable) -&gt; Callable:
-        @wraps(func)
         def role_required_wrapper(*args: tuple, **kwargs: dict) -&gt; Any:
             roles: list = []
             if metadata := get_metadata(current_user):</pre></div><div class="alert alert-secondary"><pre class="diff">============================= test session starts ==============================
platform darwin -- Python 3.11.4, pytest-7.4.3, pluggy-1.3.0
rootdir: /Users/liamtoozer/eq/eq-questionnaire-runner
configfile: setup.cfg
plugins: flask-1.3.0, xdist-3.4.0, cov-4.1.0, mock-3.12.0, sugar-0.9.7
created: 12/12 workers
12 workers [38 items]

..........................EEE.EE.E.EEE                                   [100%]
==================================== ERRORS ====================================
___________ ERROR at setup of test_no_user_when_session_has_expired ____________
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_no_user_when_session_has_expired&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10df46690&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (HEAD, OPTIONS, GET) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x10dcde160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x10dcddee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different _
[gw3] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1083e7750&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (GET, OPTIONS, HEAD) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x1081d6160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x1081d5ee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

_________ ERROR at setup of test_check_session_with_user_id_in_session _________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x109259310&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (OPTIONS, GET, HEAD) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x10901a160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x109019ee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

_______________________ ERROR at setup of test_load_user _______________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1133d64d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (GET, HEAD, OPTIONS) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x113176160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x113175ee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_should_use_token ____________________
[gw11] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_use_token&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1107d03d0&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (OPTIONS, HEAD, GET) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x112512160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x112511ee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_should_raise_jti_token_used_when_token_already_exists _
[gw8] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_should_raise_jti_token_used_when_token_already_exists&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x109574350&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (HEAD, GET, OPTIONS) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x1092f2160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x1092f1ee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

_ ERROR at setup of test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different _
[gw2] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10f0b2d50&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (HEAD, OPTIONS, GET) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x10dcde160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x10dcddee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

_______ ERROR at setup of test_check_session_with_no_user_id_in_session ________
[gw0] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_check_session_with_no_user_id_in_session&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10a497850&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (OPTIONS, GET, HEAD) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x10901a160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x109019ee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

___________________ ERROR at setup of test_request_load_user ___________________
[gw1] darwin -- Python 3.11.4 /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/bin/python

request = &lt;SubRequest '_configure_application' for &lt;Function test_request_load_user&gt;&gt;
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x1134e6090&gt;

    @pytest.fixture(autouse=True)
    def _configure_application(request, monkeypatch):
        """Use `pytest.mark.options` decorator to pass options to your application
        factory::
    
            @pytest.mark.options(debug=False)
            def test_something(app):
                assert not app.debug, 'the application works not in debug mode!'
    
        """
        if "app" not in request.fixturenames:
            return
    
&gt;       app = getfixturevalue(request, "app")

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/plugin.py:124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pytest_flask/pytest_compat.py:3: in getfixturevalue
    return request.getfixturevalue(value)
tests/app/conftest.py:40: in app
    the_app = create_app(setting_overrides=setting_overrides)
app/setup.py:198: in create_app
    add_blueprints(application)
app/setup.py:454: in add_blueprints
    application.register_blueprint(dump_blueprint)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
2023-11-16 08:22:04 [debug    ] reading from file              filename=.application-version
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-mobile-logo.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/dsit-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/dbt-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/desnz-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/finance-ni-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/orr-logo.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/orr-mobile-logo.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/ukhsa-logo-stacked.svg
2023-11-16 08:22:05 [debug    ] reading from file              filename=./templates/assets/images/ons-logo-stacked.svg
    return f(self, *args, **kwargs)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:597: in register_blueprint
    blueprint.register(self, options)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:335: in register
    deferred(state)
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:431: in &lt;lambda&gt;
    lambda s: s.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/blueprints.py:110: in add_url_rule
    self.app.add_url_rule(
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/scaffold.py:44: in wrapper_func
    return f(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Flask 'app.setup'&gt;
rule = &lt;Rule '/dump/routing-path' (GET, HEAD, OPTIONS) -&gt; dump.role_required_wrapper&gt;
endpoint = 'dump.role_required_wrapper'
view_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x113176160&gt;
provide_automatic_options = True
options = {'defaults': {}, 'endpoint': 'dump.role_required_wrapper', 'subdomain': None}
methods = {'GET', 'OPTIONS'}, required_methods = {'OPTIONS'}
old_func = &lt;function role_required.&lt;locals&gt;.role_required_decorator.&lt;locals&gt;.role_required_wrapper at 0x113175ee0&gt;

    @setupmethod
    def add_url_rule(
        self,
        rule: str,
        endpoint: str | None = None,
        view_func: ft.RouteCallable | None = None,
        provide_automatic_options: bool | None = None,
        **options: t.Any,
    ) -&gt; None:
        if endpoint is None:
            endpoint = _endpoint_from_view_func(view_func)  # type: ignore
        options["endpoint"] = endpoint
        methods = options.pop("methods", None)
    
        # if the methods are not given and the view_func object knows its
        # methods we can use that instead.  If neither exists, we go with
        # a tuple of only ``GET`` as default.
        if methods is None:
            methods = getattr(view_func, "methods", None) or ("GET",)
        if isinstance(methods, str):
            raise TypeError(
                "Allowed methods must be a list of strings, for"
                ' example: @app.route(..., methods=["POST"])'
            )
        methods = {item.upper() for item in methods}
    
        # Methods that should always be added
        required_methods = set(getattr(view_func, "required_methods", ()))
    
        # starting with Flask 0.8 the view_func object can disable and
        # force-enable the automatic options handling.
        if provide_automatic_options is None:
            provide_automatic_options = getattr(
                view_func, "provide_automatic_options", None
            )
    
        if provide_automatic_options is None:
            if "OPTIONS" not in methods:
                provide_automatic_options = True
                required_methods.add("OPTIONS")
            else:
                provide_automatic_options = False
    
        # Add the required methods now.
        methods |= required_methods
    
        rule = self.url_rule_class(rule, methods=methods, **options)
        rule.provide_automatic_options = provide_automatic_options  # type: ignore
    
        self.url_map.add(rule)
        if view_func is not None:
            old_func = self.view_functions.get(endpoint)
            if old_func is not None and old_func != view_func:
&gt;               raise AssertionError(
                    "View function mapping is overwriting an existing"
                    f" endpoint function: {endpoint}"
                )
E               AssertionError: View function mapping is overwriting an existing endpoint function: dump.role_required_wrapper

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/flask/sansio/app.py:659: AssertionError
---------------------------- Captured stdout setup -----------------------------
2023-11-16 08:22:08 [info     ] starting eq survey runner      version=local

=============================== warnings summary ===============================
../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 104 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 65 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: 52 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.logging')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.iam')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sdc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: 26 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('zope')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/google/rpc/__init__.py:20: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.rpc')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    pkg_resources.declare_namespace(__name__)

../../.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: 13 warnings
  /Users/liamtoozer/.local/share/virtualenvs/eq-questionnaire-runner-ZWwJGZwx/lib/python3.11/site-packages/htmlmin/main.py:28: DeprecationWarning: 'cgi' is deprecated and slated for removal in Python 3.13
    import cgi

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
ERROR tests/app/authentication/test_authenticator.py::test_no_user_when_session_has_expired
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_extends_session_expiry_when_expiry_greater_than_60_seconds_different
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_load_user - Assert...
ERROR tests/app/authentication/test_use_token.py::test_should_use_token - Ass...
ERROR tests/app/authentication/test_use_token.py::test_should_raise_jti_token_used_when_token_already_exists
ERROR tests/app/authentication/test_authenticator.py::test_valid_user_does_not_extend_session_expiry_when_expiry_less_than_60_seconds_different
ERROR tests/app/authentication/test_authenticator.py::test_check_session_with_no_user_id_in_session
ERROR tests/app/authentication/test_authenticator.py::test_request_load_user
================== 29 passed, 325 warnings, 9 errors in 4.53s ==================
</pre></div></div></div></div></div></div></div></div></div></div><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script><script type="text/javascript">$('div.job_list___sub_multi_collapse').on('shown.bs.collapse',  function () {    correct_behavior_functional_buttons();  });$('div.job_list___sub_multi_collapse').on('hidden.bs.collapse',  function () {    correct_behavior_functional_buttons();  });function correct_behavior_functional_buttons() {    var expand = false;    var collapse = false;    $('a.job_list___sub_multi_heading').each(function(index) {      if ($(this).attr('aria-expanded') == 'false') {        expand = true;        return false;      };    });    $('a.job_list___sub_multi_heading').each(function(index) {      if ($(this).attr('aria-expanded') == 'true') {        collapse = true;        return false;      };    });    if (expand) {      $('div#job_item_expand_all').css('display', 'inline-block');    } else {      $('div#job_item_expand_all').css('display', 'none');    };    if (collapse) {      $('div#job_item_collapse_all').css('display', 'inline-block');    } else {      $('div#job_item_collapse_all').css('display', 'none');    };  };correct_behavior_functional_buttons();</script></body></html>
