{%- if content.summary.collapsible -%}
  {%- include 'partials/summary/collapsible-summary.html' -%}
{%- else -%}
  {% from "components/summary/_macro.njk" import onsSummary %}

  {% set summaryGroups = [] %}

  {%- for group in content.summary.groups if group.blocks -%}

      {% if group.links %}
          {% set links = {"add_link_text": group.links.add_link_text, "add_link": group.links.add_link, "empty_link_text": group.links.empty_list_text} %}
      {% else %}
          {% set links = {"add_link_text": "",  "add_link": "", "empty_link_text": ""} %}
      {% endif %}

      {% set summary_link = {
        "url": links.add_link,
        "text": links.add_link_text,
        "attributes": {
          "data-qa": "add-item-link"
        }
        }
      %}

      {% do summaryGroups.append (
        {
        "groups": [
          {
            "groupTitle": group.title if group.title else None,
            "id": group.id if group.id else None,
            "rows": map_summary_item_config(
            group,
            content.summary.summary_type,
            content.summary.answers_are_editable,
            _("No answer provided"),
            _("Change"),
            _("Change your answer for:"),
            content.summary.calculated_question,
            None,
            ),
            "classes": "ons-u-mt-m" if loop.index > 1 else "",
            "placeholderText": links.empty_list_text,
            "summaryLink": summary_link,
          }
        ]
        }
      )
      %}
  {%- endfor -%}


  {{ onsSummary({
    "summaries": summaryGroups
  }) }}

{%- endif -%}

